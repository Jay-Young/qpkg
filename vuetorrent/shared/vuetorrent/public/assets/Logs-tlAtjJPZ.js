import{u as G}from"./ArrayPagination-JjYmrbrK.js";import{az as P,y as K,aA as l,aw as H,aj as Q,q as S,c as Z,r as g,k as J,d,a2 as X,s as Y,a4 as c,i as ee,N as b,ax as te,ay as le,_ as ae}from"./index-fj5-vamU.js";import{g as se,$ as oe,K as ne,d as h,c as f,M as ue,I as re,a2 as r,a7 as I,m as e,a4 as a,ab as F,Z as m,u as o,a3 as v,D as B,a9 as y,F as w,a8 as ie,a6 as de,W as N}from"./vue-EkRptf2M.js";import{d as me}from"./dayjs.min-lc5slf-X.js";import"./vuetify-FD_HUlNY.js";const ce={class:"pa-3"},pe={style:{"font-size":"1.6em !important"},class:"subtitle-1 ml-2"},ge={class:"d-flex justify-end"},fe=se({__name:"Logs",setup(ve){const x=oe(),{t:O}=ne(),V=P(),$=K(),L=h([{title:l[l.NORMAL],value:l.NORMAL},{title:l[l.INFO],value:l.INFO},{title:l[l.WARNING],value:l.WARNING},{title:l[l.CRITICAL],value:l.CRITICAL}]),u=h([l.NORMAL,l.INFO,l.WARNING,l.CRITICAL]),_=h(""),M=f(()=>V.logs),U=f(()=>M.value.filter(t=>u.value.includes(t.type))),{results:C}=H(U,_,t=>t.message),T=f(()=>u.value.length>0),k=f(()=>u.value.length===L.value.length),{paginatedResults:j,currentPage:i,pageCount:p}=G(C,30),A=()=>{x.push({name:"dashboard"})},E=t=>`logtype-${l[t?.type]?.toLowerCase()}`,W=t=>l[t.type],q=t=>me(t.timestamp*1e3).format($.dateFormat),z=()=>{k.value?u.value=[]:u.value=L.value.map(t=>t.value)},R=t=>{t.key==="Escape"&&A()};return ue(async()=>{document.addEventListener("keydown",R),await V.cleanAndFetchLogs(),Q(V.fetchLogs,15e3)}),re(()=>{document.removeEventListener("keydown",R)}),(t,n)=>(r(),I("div",ce,[e(S,{"no-gutters":"",align:"center",justify:"center"},{default:a(()=>[e(g,null,{default:a(()=>[F("h1",pe,m(o(O)("logs.title")),1)]),_:1}),e(g,null,{default:a(()=>[F("div",ge,[e(J,{icon:"mdi-close",variant:"plain",onClick:A})])]),_:1})]),_:1}),e(Z,null,{default:a(()=>[e(d,null,{default:a(()=>[e(S,null,{default:a(()=>[e(g,{cols:"6"},{default:a(()=>[e(X,{modelValue:u.value,"onUpdate:modelValue":n[0]||(n[0]=s=>u.value=s),items:L.value,label:t.$t("logs.filters.type"),"hide-details":"",multiple:"",chips:""},{"prepend-item":a(()=>[e(d,{title:t.$t("common.selectAll"),onClick:z},{prepend:a(()=>[e(Y,{indeterminate:T.value&&!k.value,"model-value":T.value},null,8,["indeterminate","model-value"])]),_:1},8,["title"]),e(c)]),_:1},8,["modelValue","items","label"])]),_:1}),e(g,{cols:"6"},{default:a(()=>[e(ee,{modelValue:_.value,"onUpdate:modelValue":n[1]||(n[1]=s=>_.value=s),label:t.$t("logs.filters.query"),"hide-details":""},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),e(c,{class:"my-3",thickness:"5"}),o(p)>1?(r(),v(d,{key:0},{default:a(()=>[e(b,{modelValue:o(i),"onUpdate:modelValue":n[2]||(n[2]=s=>B(i)?i.value=s:null),length:o(p),"prev-icon":"mdi-menu-left","next-icon":"mdi-menu-right"},null,8,["modelValue","length"])]),_:1})):y("",!0),e(c),(r(!0),I(w,null,ie(o(j),(s,D)=>(r(),I(w,null,[D>0?(r(),v(c,{key:0})):y("",!0),e(d,{class:de(E(s))},{default:a(()=>[e(te,null,{default:a(()=>[N(m(s.id)+") "+m(s.message),1)]),_:2},1024),e(le,null,{default:a(()=>[N(m(W(s))+" | "+m(q(s)),1)]),_:2},1024)]),_:2},1032,["class"])],64))),256)),o(C).length===0?(r(),v(d,{key:1},{default:a(()=>[N(m(t.$t("logs.emptyLogList")),1)]),_:1})):y("",!0),e(c),o(p)>1?(r(),v(d,{key:2},{default:a(()=>[e(b,{modelValue:o(i),"onUpdate:modelValue":n[3]||(n[3]=s=>B(i)?i.value=s:null),length:o(p),"prev-icon":"mdi-menu-left","next-icon":"mdi-menu-right"},null,8,["modelValue","length"])]),_:1})):y("",!0)]),_:1})]))}}),Ie=ae(fe,[["__scopeId","data-v-8cef5e4d"]]);export{Ie as default};

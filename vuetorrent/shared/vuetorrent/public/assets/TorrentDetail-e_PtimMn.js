import{_ as ot,a as nt}from"./dayjs-kDtb7Q-O.js";import{aM as Ae,A as De,h as z,f as J,aN as G,H as rt,Q as it,M as q,_ as pe,aO as st,p as oe,al as ut,w as T,r as me,b as be,aE as dt,aF as X,aH as Q,v as I,a4 as de,N as Z,i as ne,j as H,aB as ke,B as ae,y as He,E as ct,F as ft,T as vt,ak as pt,l as we,aP as mt,aQ as _t,g as U,aR as gt,aS as ht,G as Ce,aT as yt,m as ce,a5 as Se,aA as Ke,aU as kt,aV as Te,q as Ne,ah as Ye,a9 as qe,o as Pe,aW as Le,a2 as Re,n as wt,V as Ee,au as Dt,C as bt,av as $t,aw as Vt,ax as le}from"./index-z3dneNLh.js";import{g as K,K as _e,c as R,a3 as i,a8 as h,ab as s,Y as Oe,a4 as D,a5 as t,W as p,Z as l,aa as B,u as a,a7 as fe,m as e,ao as Xe,a0 as Tt,w as ve,x as xe,I as $e,A as Qe,a6 as We,a9 as E,au as Ct,F,d as O,a2 as Me,N as ze,n as Ie,r as St,ap as Nt,$ as Pt,a as Ot,q as It}from"./vue-7zd71vkt.js";import{Z as Ze,ap as At}from"./vuetify-10uagJf8.js";import{d as Ge}from"./dayjs.min-cr8_29QK.js";import{_ as xt}from"./MoveTorrentFileDialog.vue_vue_type_script_setup_true_lang-sQXNILKL.js";var ye=(y=>(y[y.MISSING=0]="MISSING",y[y.DOWNLOADING=1]="DOWNLOADING",y[y.DOWNLOADED=2]="DOWNLOADED",y))(ye||{}),Y=(y=>(y[y.DISABLED=0]="DISABLED",y[y.NOT_YET_CONTACTED=1]="NOT_YET_CONTACTED",y[y.WORKING=2]="WORKING",y[y.UPDATING=3]="UPDATING",y[y.NOT_WORKING=4]="NOT_WORKING",y))(Y||{});const zt={pdf:"mdi-file-pdf-box",png:"mdi-file-image",jpg:"mdi-file-image",jpeg:"mdi-file-image",tiff:"mdi-file-image",doc:"mdi-file-document",docx:"mdi-file-document",txt:"mdi-file-document",nfo:"mdi-information-variant-box",mp3:"mdi-music",wav:"mdi-music",flac:"mdi-music",avi:"mdi-movie",mp4:"mdi-movie",mkv:"mdi-movie",mov:"mdi-movie",wmv:"mdi-movie",srt:"mdi-subtitles",idx:"mdi-subtitles",sub:"mdi-subtitles",rar:"mdi-zip-box-outline",zip:"mdi-zip-box-outline",gz:"mdi-zip-box-outline","7z":"mdi-zip-box-outline",iso:"mdi-zip-box-outline",exe:"mdi-application-brackets",msi:"mdi-application-brackets",dmg:"mdi-application-brackets",deb:"mdi-application-brackets",jar:"mdi-application-brackets"};function Bt(y){const u=y.split(".").pop()?.toLowerCase()||"";return zt[u]||"mdi-file"}const Ut={class:"d-flex"},Ft={class:"d-flex flex-column overflow-hidden text-no-wrap mr-3"},Lt={class:"text-grey"},Rt={class:"d-flex align-center"},je="#ffe476",Et=K({__name:"ContentNode",props:{node:{},openedItems:{}},emits:["setFilePrio","onRightClick"],setup(y,{emit:u}){const d=y,g=u,{t:$}=_e(),{mobile:A}=Ze(),S=Ae(),v=De(),f=R(()=>{if(d.node.name==="(root)")return 0;const r=d.node.fullName.split("/").length,o=A.value?12:24;return r*o});function V(r,o){if(o.type==="file")return;r.stopPropagation();const c=d.openedItems.indexOf(o.fullName);c===-1?d.openedItems.push(o.fullName):d.openedItems.splice(c,1)}async function w(r){r.getPriority()===G.DO_NOT_DOWNLOAD?g("setFilePrio",r.getChildrenIds(),G.NORMAL):g("setFilePrio",r.getChildrenIds(),G.DO_NOT_DOWNLOAD)}function C(r,o){it(r)?S.internalSelection.has(o.fullName)?S.internalSelection.delete(o.fullName):S.internalSelection.add(o.fullName):S.internalSelection=new Set([o.fullName])}function _(r){return r.getPriority()===G.DO_NOT_DOWNLOAD?"grey":r.getProgress()===1?"green":""}function N(r){const[o,c]=r.getDeepCount(),m=[];return o>1&&m.push($("torrentDetail.content.folderInfo",o-1)),c>0&&m.push($("torrentDetail.content.fileInfo",c)),m.join(", ")}function b(r){const o=[q(r.getSize(),v.useBinarySize)];return r.type==="folder"&&o.push(N(r)),o.join(" | ")}return(r,o)=>(i(),h("div",{class:fe(["d-flex flex-column py-2 pr-3",r.node.isSelected(a(S).internalSelection)?"selected":""]),style:Xe(`padding-left: ${f.value}px`),onClick:o[2]||(o[2]=Oe(c=>C(c,r.node),["stop"])),onContextmenu:o[3]||(o[3]=c=>r.$emit("onRightClick",c,r.node))},[s("div",Ut,[s("div",{class:"d-flex align-center",onClick:o[0]||(o[0]=Oe(c=>w(r.node),["stop"]))},[r.node.isWanted()===null?(i(),D(z,{key:0,color:_(r.node),icon:"mdi-checkbox-intermediate-variant"},null,8,["color"])):r.node.isWanted()?(i(),D(z,{key:1,color:_(r.node),icon:"mdi-checkbox-marked"},null,8,["color"])):(i(),D(z,{key:2,color:_(r.node),icon:"mdi-checkbox-blank-outline"},null,8,["color"]))]),s("div",{class:"d-flex align-center spacer",onClick:o[1]||(o[1]=c=>V(c,r.node))},[r.node.type==="folder"?(i(),D(z,{key:0},{default:t(()=>[p(l(r.openedItems.includes(r.node.fullName)?"mdi-chevron-up":"mdi-chevron-down"),1)]),_:1})):B("",!0),r.node.name==="(root)"?(i(),D(z,{key:1,icon:"mdi-file-tree"})):r.node.type==="file"?(i(),D(z,{key:2,icon:a(Bt)(r.node.name)},null,8,["icon"])):r.openedItems.includes(r.node.fullName)?(i(),D(z,{key:3,icon:"mdi-folder-open",color:je})):(i(),D(z,{key:4,icon:"mdi-folder",color:je}))]),s("div",Ft,[s("div",{class:fe(`text-${_(r.node)}`)},l(r.node.name),3),s("div",Lt,l(b(r.node)),1)]),e(J),s("div",Rt,[r.node.getPriority()===a(G).MAXIMAL?(i(),D(z,{key:0,color:"error"},{default:t(()=>[p("mdi-arrow-up")]),_:1})):r.node.getPriority()===a(G).HIGH?(i(),D(z,{key:1,color:"warning"},{default:t(()=>[p("mdi-arrow-top-right")]),_:1})):r.node.getPriority()===a(G).NORMAL?(i(),D(z,{key:2},{default:t(()=>[p("mdi-minus")]),_:1})):r.node.getPriority()===a(G).MIXED?(i(),D(z,{key:3},{default:t(()=>[p("mdi-tilde")]),_:1})):r.node.getPriority()===a(G).DO_NOT_DOWNLOAD?(i(),D(z,{key:4,color:"grey"},{default:t(()=>[p("mdi-cancel")]),_:1})):B("",!0)])]),e(rt,{"model-value":r.node.getProgress(),max:1,color:_(r.node),rounded:"sm"},null,8,["model-value","color"])],38))}}),Wt=pe(Et,[["__scopeId","data-v-4821ee2d"]]),Mt=K({__name:"Content",props:{torrent:{},isActive:{type:Boolean}},setup(y){const u=y,{height:d}=Ze(),g=Ae(),{rightClickProperties:$,openedItems:A,flatTree:S,internalSelection:v}=Tt(g),f=R(()=>d.value-48*2-64-12*2);async function V(w,C){$.value.isVisible&&($.value.isVisible=!1,await Qe()),Object.assign($.value,{isVisible:!0,offset:[w.pageX,w.pageY],hash:u.torrent.hash}),v.value.size<=1&&(v.value=new Set([C.fullName]))}return ve(()=>u.isActive,w=>{w?(g.resumeTimer(),g.updateFileTree()):g.pauseTimer()}),xe(()=>{v.value.clear(),g.resumeTimer()}),$e(()=>g.$reset()),(w,C)=>(i(),D(oe,null,{default:t(()=>[e(st,{id:"tree-root",items:a(S),height:f.value,"item-height":"68",class:"pa-2"},{default:t(({item:_})=>[e(Wt,{"opened-items":a(A),node:_,onSetFilePrio:C[0]||(C[0]=(N,b)=>a(g).setFilePriority(N,b)),onOnRightClick:C[1]||(C[1]=(N,b)=>V(N,b))},null,8,["opened-items","node"])]),_:1},8,["items","height"])]),_:1}))}}),Gt={class:"pl-4"},jt={class:"pr-4"},j=K({__name:"InfoBase",props:{compact:{type:Boolean}},setup(y){return(u,d)=>(i(),D(T,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(ut,{rounded:"xl",class:"d-flex align-center py-2 border"},{default:t(()=>[s("div",Gt,[We(u.$slots,"title")]),e(J),s("div",jt,[We(u.$slots,"text")])]),_:3})]),_:3}))}}),Ht={key:0,class:"d-flex gap"},Kt=K({__name:"Info",props:{torrent:{},isActive:{type:Boolean}},setup(y){const u=y,d=me(),g=be(),$=De(),A=R({get:()=>u.torrent.auto_tmm,set:o=>d.toggleAutoTmm([u.torrent.hash],o)}),S=R({get:()=>u.torrent.f_l_piece_prio,set:()=>d.toggleFLPiecePrio([u.torrent.hash])}),v=R({get:()=>u.torrent.forced,set:o=>{o?g.forceResumeTorrents([u.torrent.hash]):g.resumeTorrents([u.torrent.hash])}}),f=R({get:()=>u.torrent.seq_dl,set:()=>d.toggleSeqDl([u.torrent.hash])}),V=R({get:()=>u.torrent.super_seeding,set:o=>d.setSuperSeeding([u.torrent.hash],o)}),w=[{title:"added_on",text:"added_on"},{title:"completed_on",text:"completed_on"},{title:"last_activity",text:"last_activity"},{title:"seen_complete",text:"seen_complete"}],C=[{title:"ratio_time_limit",text:"ratio_time_limit"},{title:"seeding_time",text:"seeding_time"},{title:"time_active",text:"time_active"}],_=[{title:"downloaded",text:"downloaded"},{title:"downloaded_session",text:"downloaded_session"},{title:"uploaded",text:"uploaded"},{title:"uploaded_session",text:"uploaded_session"},{title:"size",text:"size"},{title:"total_size",text:"total_size"},{title:"amount_left",text:"amount_left"},{title:"global_volume",text:"globalVolume"}],N=[{title:"download_limit",text:"dl_limit"},{title:"download_speed",text:"dlspeed"},{title:"upload_limit",text:"up_limit"},{title:"upload_speed",text:"upspeed"},{title:"avg_download_speed",text:"avgDownloadSpeed"},{title:"avg_upload_speed",text:"avgUploadSpeed"},{title:"global_speed",text:"globalSpeed"}],b=[{title:"available_peers",text:"available_peers"},{title:"available_seeds",text:"available_seeds"},{title:"num_leechs",text:"num_leechs"},{title:"num_seeds",text:"num_seeds"},{title:"ratio",text:"ratio"},{title:"ratio_limit",text:"ratio_limit"},{title:"availability",text:"availability"},{title:"eta",text:"eta"},{title:"category",text:"category"},{title:"state",text:"stateString"},{title:"trackers_count",text:"trackers_count"},{title:"priority",text:"priority"}],r=[{title:"content_path",text:"content_path"},{title:"download_path",text:"download_path"},{title:"hash",text:"hash"},{title:"infohash_v1",text:"infohash_v1"},{title:"infohash_v2",text:"infohash_v2"},{title:"magnet",text:"magnet"},{title:"name",text:"name"},{title:"save_path",text:"savePath"},{title:"tracker",text:"tracker"}];return(o,c)=>(i(),D(ne,null,{default:t(()=>[e(H,null,{default:t(()=>[e(dt,null,{default:t(()=>[e(X,{title:o.$t("torrentDetail.info.datetime_values")},{default:t(()=>[e(Q,null,{default:t(()=>[e(I,null,{default:t(()=>[(i(),h(F,null,E(w,m=>e(j,null,Ct({title:t(()=>[p(l(o.$t(`torrent.properties.${m.title}`)),1)]),_:2},[o.torrent[m.text]>0?{name:"text",fn:t(()=>[p(l(a(Ge)(o.torrent[m.text]*1e3).format(a($).dateFormat??"DD/MM/YYYY, HH:mm:ss")),1)]),key:"0"}:{name:"text",fn:t(()=>[p(l(o.$t("common.NA")),1)]),key:"1"}]),1024)),64))]),_:1})]),_:1})]),_:1},8,["title"]),e(X,{title:o.$t("torrentDetail.info.duration_values")},{default:t(()=>[e(Q,null,{default:t(()=>[e(I,null,{default:t(()=>[(i(),h(F,null,E(C,m=>e(j,null,{title:t(()=>[p(l(o.$t(`torrent.properties.${m.title}`)),1)]),text:t(()=>[p(l(a(Ge).duration(o.torrent[m.text],"s").humanize()),1)]),_:2},1024)),64))]),_:1})]),_:1})]),_:1},8,["title"]),e(X,{title:o.$t("torrentDetail.info.boolean_values")},{default:t(()=>[e(Q,null,{default:t(()=>[e(I,null,{default:t(()=>[e(j,null,{title:t(()=>[e(de,{modelValue:A.value,"onUpdate:modelValue":c[0]||(c[0]=m=>A.value=m),"hide-details":"",density:"compact",label:o.$t("torrent.properties.auto_tmm")},null,8,["modelValue","label"])]),_:1}),e(j,null,{title:t(()=>[e(de,{modelValue:S.value,"onUpdate:modelValue":c[1]||(c[1]=m=>S.value=m),"hide-details":"",density:"compact",label:o.$t("torrent.properties.f_l_piece_prio")},null,8,["modelValue","label"])]),_:1}),e(j,null,{title:t(()=>[e(de,{modelValue:v.value,"onUpdate:modelValue":c[2]||(c[2]=m=>v.value=m),"hide-details":"",density:"compact",label:o.$t("torrent.properties.forced")},null,8,["modelValue","label"])]),_:1}),e(j,null,{title:t(()=>[e(de,{modelValue:f.value,"onUpdate:modelValue":c[3]||(c[3]=m=>f.value=m),"hide-details":"",density:"compact",label:o.$t("torrent.properties.seq_dl")},null,8,["modelValue","label"])]),_:1}),e(j,null,{title:t(()=>[e(de,{modelValue:V.value,"onUpdate:modelValue":c[4]||(c[4]=m=>V.value=m),"hide-details":"",density:"compact",label:o.$t("torrent.properties.super_seeding")},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1})]),_:1},8,["title"]),e(X,{title:o.$t("torrentDetail.info.data_values")},{default:t(()=>[e(Q,null,{default:t(()=>[e(I,null,{default:t(()=>[(i(),h(F,null,E(_,m=>e(j,null,{title:t(()=>[p(l(o.$t(`torrent.properties.${m.title}`)),1)]),text:t(()=>[p(l(a(q)(o.torrent[m.text],a($).useBinarySize)),1)]),_:2},1024)),64))]),_:1})]),_:1})]),_:1},8,["title"]),e(X,{title:o.$t("torrentDetail.info.speed_values")},{default:t(()=>[e(Q,null,{default:t(()=>[e(I,null,{default:t(()=>[(i(),h(F,null,E(N,m=>e(j,null,{title:t(()=>[p(l(o.$t(`torrent.properties.${m.title}`)),1)]),text:t(()=>[p(l(a(Z)(o.torrent[m.text],a($).useBitSpeed)),1)]),_:2},1024)),64))]),_:1})]),_:1})]),_:1},8,["title"]),e(X,{title:o.$t("torrentDetail.info.text_values")},{default:t(()=>[e(Q,null,{default:t(()=>[e(I,null,{default:t(()=>[(i(),h(F,null,E(b,m=>e(j,null,{title:t(()=>[p(l(o.$t(`torrent.properties.${m.title}`)),1)]),text:t(()=>[p(l(o.torrent[m.text]),1)]),_:2},1024)),64))]),_:1})]),_:1})]),_:1},8,["title"]),e(X,{title:o.$t("torrentDetail.info.long_text_values")},{default:t(()=>[e(Q,null,{default:t(()=>[e(ne,null,{default:t(()=>[(i(),h(F,null,E(r,m=>e(H,{title:o.$t(`torrent.properties.${m.title}`)},{default:t(()=>[e(ke,null,{default:t(()=>[p(l(o.torrent[m.text]),1)]),_:2},1024)]),_:2},1032,["title"])),64)),e(H,{title:o.$t("torrent.properties.tags")},{default:t(()=>[o.torrent.tags?.length?(i(),h("div",Ht,[(i(!0),h(F,null,E(o.torrent.tags,m=>(i(),D(ae,{variant:"flat",color:"tag"},{default:t(()=>[p(l(m),1)]),_:2},1024))),256))])):(i(),D(ke,{key:1},{default:t(()=>[p(l(o.$t("torrent.properties.empty_tags")),1)]),_:1}))]),_:1},8,["title"])]),_:1})]),_:1})]),_:1},8,["title"])]),_:1})]),_:1})]),_:1}))}}),Yt=pe(Kt,[["__scopeId","data-v-bb1329d2"]]),qt=["href"],Xt={key:1},Qt={class:"my-1"},Zt={class:"mr-2"},Jt={key:0},el={key:2},tl={key:0},ll={key:1},al={key:2},ol={key:3},nl={key:4},rl={key:0},il=K({__name:"Overview",props:{torrent:{},isActive:{type:Boolean}},setup(y){const u=y,{t:d}=_e(),g=At(),$=He(),A=me(),S=be(),v=De(),f=O(),V=O(""),w=O(0),C=O([]),_=O(0),N=O(0),b=O(""),r=O(0),o=O(0),c=O(0),m=O(0),re=R(()=>`torrent-${u.torrent.state}`),ie=R(()=>`${parseInt(ct(r.value,!0))} ${ft(r.value,!0)}`),k=R(()=>u.torrent.state===vt.META_DL),x=R(()=>!k.value&&c.value>0&&c.value<v.canvasRenderThreshold),P=R(()=>x.value&&c.value<v.canvasRefreshThreshold);async function ge(){const n=await S.getTorrentProperties(u.torrent.hash);V.value=n.comment,w.value=n.dl_speed_avg,c.value=n.pieces_num,o.value=n.pieces_have,r.value=n.piece_size,m.value=n.up_speed_avg}async function M(){C.value=await A.fetchFiles(u.torrent.hash),N.value=C.value.length;const n=C.value.filter(W=>W.priority!==G.DO_NOT_DOWNLOAD);_.value=n.length,_.value===1&&(b.value=n[0].name)}async function Be(){if(!f.value)return;const n=await A.fetchPieceState(u.torrent.hash);f.value.width=n.length||-1;const W=f.value.getContext("2d");W.clearRect(0,0,f.value.width,f.value.height);let L="",ee=1;for(let te=0;te<n.length;++te){const Ve=n[te];let se="";if(Ve===ye.DOWNLOADING)se=g.current.value.colors["torrent-downloading"];else if(Ve===ye.DOWNLOADED)se=g.current.value.colors["torrent-pausedUP"];else if(Ve===ye.MISSING){const lt=C.value.filter(ue=>ue.priority!==G.DO_NOT_DOWNLOAD).map(ue=>ue.piece_range);for(const[ue,at]of lt)if(te>ue&&te<at){se=g.current.value.colors["torrent-pausedDL"];break}}if(se===L){++ee;continue}L!==""&&(W.fillStyle=L,W.fillRect(te-ee,0,ee,f.value.height)),ee=1,L=se}L!==""&&(W.fillStyle=L,W.fillRect(n.length-ee,0,ee,f.value.height))}async function Je(){try{await navigator.clipboard.writeText(u.torrent.hash)}catch{Me.error(d("toast.copy.error"));return}Me.success(d("toast.copy.success"))}function he(n){$.createDialog(ot,{hashes:[u.torrent.hash],mode:n})}function Ue(){$.createDialog(xt,{hash:u.torrent.hash,isFolder:!1,oldName:b.value})}const{resume:et,pause:tt}=pt(async()=>{await M(),P.value&&await Be()},v.fileContentInterval,{immediate:!0,immediateCallback:!0});ve(()=>u.isActive,n=>{n?et():tt()}),ve(()=>u.torrent,async()=>{await ge()});function Fe(n){if($.hasActiveDialog)return!1;if(n.key==="d")return n.preventDefault(),he("dl"),!0;if(n.key==="s")return n.preventDefault(),he("save"),!0;if(n.key==="f"&&_.value===1)return n.preventDefault(),Ue(),!0}return xe(()=>{document.addEventListener("keydown",Fe)}),$e(()=>{document.removeEventListener("keydown",Fe)}),(n,W)=>n.torrent?(i(),D(oe,{key:0},{default:t(()=>[e(we,{class:"text-wrap"},{default:t(()=>[p(l(n.torrent.name),1)]),_:1}),e(gt,null,{default:t(()=>[s("div",null,[(i(!0),h(F,null,E(a(_t)(V.value),L=>(i(),h("span",null,[a(mt)(L)?(i(),h("a",{key:0,target:"_blank",href:L},l(L),9,qt)):(i(),h("span",Xt,l(L),1))]))),256))]),s("div",Qt,[s("span",Zt,l(n.torrent.hash),1),e(U,{variant:"outlined",rounded:"",onClick:Je},{default:t(()=>[p(l(n.$t("torrentDetail.overview.copy_hash")),1)]),_:1})])]),_:1}),e(ce,null,{default:t(()=>[e(I,null,{default:t(()=>[e(T,{cols:"12",md:"6"},{default:t(()=>[e(I,null,{default:t(()=>[e(T,{cols:"4"},{default:t(()=>[e(ht,{color:re.value,indeterminate:k.value,size:100,"model-value":n.torrent?.progress*100||0,width:15},{default:t(()=>[k.value?(i(),h("span",Jt,l(n.$t("torrentDetail.overview.fetchingMetadata")),1)):n.torrent.progress===1?(i(),D(z,{key:1,icon:"mdi-check",size:"x-large"})):(i(),h("span",el,l(a(Ce)(n.torrent.progress)),1))]),_:1},8,["color","indeterminate","model-value"])]),_:1}),e(T,{cols:"8",class:"d-flex flex-column align-center justify-center"},{default:t(()=>[k.value?(i(),h("div",tl,[s("span",null,l(n.$t("torrentDetail.overview.waitingForMetadata")),1)])):x.value?(i(),h("div",ll,[s("canvas",{ref_key:"canvas",ref:f,width:"0",height:"10"},null,512)])):B("",!0),!k.value&&!x.value?(i(),h("div",al,[s("span",null,l(n.$t("torrentDetail.overview.canvasRenderDisabled")),1)])):!k.value&&!P.value?(i(),h("div",ol,[s("span",null,l(n.$t("torrentDetail.overview.canvasRefreshDisabled")),1)])):B("",!0),c.value>0?(i(),h("div",nl,[s("span",null,l(a(d)("torrentDetail.overview.pieceCount",{owned:o.value,total:c.value,pieceSize:ie.value})),1)])):B("",!0),s("div",null,[e(z,{icon:"mdi-arrow-down"}),p(" "+l(a(Z)(n.torrent.dlspeed,a(v).useBitSpeed))+" ",1),e(z,{icon:"mdi-arrow-up"}),p(" "+l(a(Z)(n.torrent.upspeed,a(v).useBitSpeed)),1)])]),_:1})]),_:1}),e(I,null,{default:t(()=>[e(T,{cols:"6"},{default:t(()=>[s("div",null,l(n.$t("torrent.properties.download_path"))+":",1),s("div",null,l(n.torrent.download_path),1),e(U,{icon:"mdi-pencil",color:"accent",size:"x-small",onClick:W[0]||(W[0]=L=>he("dl"))})]),_:1}),e(T,{cols:"6"},{default:t(()=>[s("div",null,l(n.$t("torrentDetail.overview.fileCount"))+":",1),s("div",null,l(_.value)+" / "+l(N.value),1),_.value===1?(i(),h("div",rl,l(b.value),1)):B("",!0),_.value===1?(i(),D(U,{key:1,icon:"mdi-pencil",color:"accent",size:"x-small",onClick:Ue})):B("",!0)]),_:1})]),_:1}),e(I,null,{default:t(()=>[e(T,{cols:"6"},{default:t(()=>[s("div",null,l(n.$t("torrent.properties.save_path"))+":",1),s("div",null,l(n.torrent.savePath),1),e(U,{icon:"mdi-pencil",color:"accent",size:"x-small",onClick:W[1]||(W[1]=L=>he("save"))})]),_:1}),e(T,{cols:"6"},{default:t(()=>[s("div",null,l(n.$t("torrent.properties.content_path"))+":",1),s("div",null,l(n.torrent.content_path),1)]),_:1})]),_:1})]),_:1}),e(T,{cols:"12",md:"6"},{default:t(()=>[e(I,null,{default:t(()=>[e(T,{cols:"6"},{default:t(()=>[s("div",null,l(n.$t("torrent.properties.state"))+":",1),e(ae,{variant:"flat",color:re.value},{default:t(()=>[p(l(n.$t(`torrent.state.${n.torrent.state}`)),1)]),_:1},8,["color"])]),_:1}),e(T,{cols:"6"},{default:t(()=>[s("div",null,l(n.$t("torrent.properties.category"))+":",1),e(ae,{variant:"flat",color:"category"},{default:t(()=>[p(l(n.torrent.category.length?n.torrent.category:n.$t("navbar.side.filters.uncategorized")),1)]),_:1})]),_:1})]),_:1}),e(I,null,{default:t(()=>[e(T,{cols:"6"},{default:t(()=>[s("div",null,l(n.$t("torrent.properties.tracker"))+":",1),e(ae,{variant:"flat",color:"tracker"},{default:t(()=>[p(l(n.torrent.tracker?a(yt)(n.torrent.tracker):n.$t("navbar.side.filters.untracked")),1)]),_:1})]),_:1}),e(T,{cols:"6",class:"d-flex flex-wrap chipgap"},{default:t(()=>[s("div",null,l(n.$t("torrent.properties.tags"))+":",1),n.torrent.tags?(i(!0),h(F,{key:0},E(n.torrent.tags,L=>(i(),D(ae,{key:L,variant:"flat",color:"tag"},{default:t(()=>[p(l(L),1)]),_:2},1024))),128)):B("",!0),!n.torrent.tags||n.torrent.tags.length===0?(i(),D(ae,{key:1,variant:"flat",color:"tag"},{default:t(()=>[p(l(n.$t("navbar.side.filters.untagged")),1)]),_:1})):B("",!0)]),_:1})]),_:1}),e(I,null,{default:t(()=>[e(T,{cols:"6"},{default:t(()=>[s("div",null,l(n.$t("torrentDetail.overview.selectedFileSize"))+":",1),s("div",null,l(a(q)(n.torrent.size,a(v).useBinarySize))+" / "+l(a(q)(n.torrent.total_size,a(v).useBinarySize)),1)]),_:1}),e(T,{cols:"6"},{default:t(()=>[s("div",null,l(n.$t("torrentDetail.overview.ratio"))+":",1),s("div",null,l(n.torrent.ratio),1)]),_:1})]),_:1}),e(I,null,{default:t(()=>[e(T,{cols:"6"},{default:t(()=>[s("div",null,l(n.$t("torrentDetail.overview.downloaded"))+":",1),s("div",null,l(a(q)(n.torrent.downloaded,a(v).useBinarySize)),1)]),_:1}),e(T,{cols:"6"},{default:t(()=>[s("div",null,l(n.$t("torrentDetail.overview.uploaded"))+":",1),s("div",null,l(a(q)(n.torrent.uploaded,a(v).useBinarySize)),1)]),_:1})]),_:1}),e(I,null,{default:t(()=>[e(T,{cols:"6"},{default:t(()=>[s("div",null,l(n.$t("torrentDetail.overview.dlSpeedAverage"))+":",1),s("div",null,l(a(Z)(w.value,a(v).useBitSpeed)),1)]),_:1}),e(T,{cols:"6"},{default:t(()=>[s("div",null,l(n.$t("torrentDetail.overview.upSpeedAverage"))+":",1),s("div",null,l(a(Z)(m.value,a(v).useBitSpeed)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):B("",!0)}}),sl=pe(il,[["__scopeId","data-v-a676963e"]]),ul={class:"d-flex"},dl={key:0},cl=["alt","src","title"],fl=["title"],vl={class:"text-subtitle-2 text-grey"},pl=["title"],ml={class:"d-flex flex-column"},_l={class:"text-h5"},gl=K({__name:"Peers",props:{torrent:{},isActive:{type:Boolean}},setup(y){const u=y,{t:d}=_e(),g=me(),$=De(),A=O(!1),S=O([]),v=O(""),f=O(null),V=O(!1);async function w(){A.value=!0,S.value=Object.entries((await g.getTorrentPeers(u.torrent.hash)).peers).map(([r,o])=>({...o,host:r})),A.value=!1}async function C(){v.value.length&&(await g.addTorrentPeers(u.torrent.hash,v.value.split(`
`)),await w(),_())}function _(){V.value=!1,v.value=""}async function N(r){await g.banPeers([r.host]),await w()}async function b(r){r??u.isActive?(await w(),f.value=setInterval(w,5e3)):(clearInterval(f.value),f.value=null)}return ze(b),$e(()=>b(!1)),ve(()=>u.isActive,b),(r,o)=>(i(),D(ne,null,{default:t(()=>[(i(!0),h(F,null,E(S.value,(c,m)=>(i(),h(F,null,[m>0?(i(),D(Se,{key:0,color:"white"})):B("",!0),e(H,null,{default:t(()=>[s("div",ul,[s("div",null,[e(Ke,{class:"overflow-visible"},{default:t(()=>[c.country_code?(i(),h("span",dl,[a(kt)?(i(),h("img",{key:0,alt:a(Te)(c.country_code).char,src:a(Te)(c.country_code).url,title:c.country,style:{"max-width":"32px"}},null,8,cl)):(i(),h("span",{key:1,title:c.country},l(a(Te)(c.country_code).char),9,fl))])):B("",!0),s("span",null,l(c.ip),1),s("span",vl," :"+l(c.port),1)]),_:2},1024),e(ke,{class:"d-block"},{default:t(()=>[s("div",null,[p(" Flags: "),s("span",{class:"cursor-help",title:c.flags_desc},l(c.flags),9,pl)]),s("div",null,"Progress: "+l(a(Ce)(c.progress)),1),s("div",null,[e(z,{icon:"mdi-arrow-down",color:"download"}),p(" "+l(a(Z)(c.dl_speed,a($).useBitSpeed))+" ",1),e(z,{icon:"mdi-arrow-up",color:"upload"}),p(" "+l(a(Z)(c.up_speed,a($).useBitSpeed)),1)]),s("div",null,l(a(q)(c.downloaded,a($).useBinarySize))+" | "+l(a(q)(c.uploaded,a($).useBinarySize)),1),s("div",null,"Relevance: "+l(a(Ce)(c.relevance)),1)]),_:2},1024)]),e(J),s("div",ml,[e(U,{color:"red",icon:"mdi-cancel",variant:"text",onClick:re=>N(c)},null,8,["onClick"])])])]),_:2},1024)],64))),256)),S.value.length===0?(i(),D(H,{key:0},{default:t(()=>[p(l(r.$t("torrentDetail.peers.emptyList")),1)]),_:1})):B("",!0),e(H,null,{default:t(()=>[s("div",{class:fe(["d-flex gap py-5",r.$vuetify.display.mobile?"flex-column":"justify-space-evenly"])},[e(Ne,{modelValue:V.value,"onUpdate:modelValue":o[1]||(o[1]=c=>V.value=c),"max-width":"750px"},{activator:t(({props:c})=>[e(U,Ie(c,{variant:"flat",text:a(d)("torrentDetail.peers.addPeers.title"),color:"accent"}),null,16,["text"])]),default:t(()=>[e(oe,null,{default:t(()=>[e(we,null,{default:t(()=>[s("span",_l,l(a(d)("torrentDetail.peers.addPeers.title")),1)]),_:1}),e(ce,null,{default:t(()=>[e(Ye,null,{default:t(()=>[e(I,null,{default:t(()=>[e(T,{cols:"12"},{default:t(()=>[e(qe,{modelValue:v.value,"onUpdate:modelValue":o[0]||(o[0]=c=>v.value=c),label:a(d)("torrentDetail.peers.addPeers.newPeers"),placeholder:a(d)("torrentDetail.peers.addPeers.newPeersPlaceholder"),hint:a(d)("torrentDetail.peers.addPeers.newPeersHint")},null,8,["modelValue","label","placeholder","hint"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Pe,null,{default:t(()=>[e(J),e(U,{color:"error",onClick:_},{default:t(()=>[p(l(a(d)("common.cancel")),1)]),_:1}),e(U,{color:"accent",onClick:C},{default:t(()=>[p(l(a(d)("common.ok")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],2)]),_:1})]),_:1}))}}),hl=pe(gl,[["__scopeId","data-v-4f9dc7e6"]]),yl=K({__name:"TagsAndCategories",props:{torrent:{},isActive:{type:Boolean}},setup(y){const u=y,d=me(),g=be(),$=R(()=>d.categories.map(f=>f.name).indexOf(u.torrent.category)),A=R(()=>d.tags.filter(f=>u.torrent.tags?.includes(f)));async function S(f){u.torrent.category===f?await g.setTorrentCategory([u.torrent.hash],""):await g.setTorrentCategory([u.torrent.hash],f)}async function v(f){u.torrent.tags?.includes(f)?await g.removeTorrentTags([u.torrent.hash],[f]):await g.addTorrentTags([u.torrent.hash],[f])}return ze(async()=>{await d.fetchCategories(),await d.fetchTags()}),(f,V)=>(i(),D(oe,null,{default:t(()=>[e(ce,null,{default:t(()=>[e(I,null,{default:t(()=>[e(T,{cols:"12",md:"6"},{default:t(()=>[e(Le,{"model-value":A.value,multiple:""},{default:t(()=>[e(ne,null,{default:t(()=>[e(Re,null,{default:t(()=>[p(l(f.$t("torrentDetail.tagsAndCategories.tags")),1)]),_:1}),(i(!0),h(F,null,E(a(d).tags,w=>(i(),D(H,{title:w,variant:f.torrent.tags?.includes(w)?"tonal":void 0,"base-color":f.torrent.tags?.includes(w)?"accent":void 0,onClick:C=>v(w)},null,8,["title","variant","base-color","onClick"]))),256))]),_:1})]),_:1},8,["model-value"])]),_:1}),e(T,{cols:"12",md:"6"},{default:t(()=>[e(Le,{"model-value":$.value},{default:t(()=>[e(ne,null,{default:t(()=>[e(Re,null,{default:t(()=>[p(l(f.$t("torrentDetail.tagsAndCategories.categories")),1)]),_:1}),(i(!0),h(F,null,E(a(d).categories,w=>(i(),D(H,{title:w.name,variant:w.name===u.torrent.category?"tonal":void 0,"base-color":w.name===u.torrent.category?"accent":void 0,onClick:C=>S(w.name)},null,8,["title","variant","base-color","onClick"]))),256))]),_:1})]),_:1},8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1}))}}),kl={class:"d-flex"},wl={key:0},Dl={key:1},bl={key:2},$l={key:3},Vl={key:0,class:"d-flex flex-column"},Tl={class:"text-h5"},Cl={class:"text-h5"},Sl=K({__name:"Trackers",props:{torrent:{},isActive:{type:Boolean}},setup(y){const u=y,{t:d}=_e(),g=me();function $(k){switch(k){case Y.DISABLED:return d("constants.trackerStatus.disabled");case Y.NOT_YET_CONTACTED:return d("constants.trackerStatus.not_yet_contacted");case Y.WORKING:return d("constants.trackerStatus.working");case Y.UPDATING:return d("constants.trackerStatus.updating");case Y.NOT_WORKING:return d("constants.trackerStatus.not_working");default:return""}}function A(k){return typeof k=="number"?k===-1?"N/A":k.valueOf():!k||k.num_peers===-1||k?.num_seeds===-1||k?.num_leeches===-1?"N/A":d("torrentDetail.trackers.peersValue",{peers:k.num_peers,seeds:k.num_seeds,leeches:k.num_leeches})}const S=O(!1),v=O([]),f=O(""),V=O(null),w=O(!1),C=[k=>!!k||d("torrentDetail.trackers.editTracker.newUrlRequired")],_=St({isVisible:!1,isFormValid:!1,oldUrl:"",newUrl:""});function N(k){_.isVisible=!0,_.oldUrl=k.url,_.newUrl=k.url,Qe(()=>{document.getElementById("input")?.select()})}async function b(){S.value=!0,v.value=(await g.getTorrentTrackers(u.torrent.hash)).map(k=>({...k,isSelectable:k.tier!==-1})),S.value=!1}async function r(){f.value.length&&(await g.addTorrentTrackers(u.torrent.hash,f.value),await b(),o())}function o(){w.value=!1,f.value=""}async function c(){_.isFormValid&&(await g.editTorrentTracker(u.torrent.hash,_.oldUrl,_.newUrl),_.isVisible=!1,await b())}async function m(k){await g.removeTorrentTrackers(u.torrent.hash,[k.url]),await b()}async function re(){await g.reannounceTorrents([u.torrent.hash])}async function ie(k){k??u.isActive?(await b(),V.value=setInterval(b,5e3)):(clearInterval(V.value),V.value=null)}return ze(ie),$e(()=>ie(!1)),ve(()=>u.isActive,ie),(k,x)=>(i(),D(ne,null,{default:t(()=>[(i(!0),h(F,null,E(v.value,(P,ge)=>(i(),h(F,null,[ge===3?(i(),D(Se,{key:0,color:"white",thickness:"5"})):ge>0?(i(),D(Se,{key:1,class:"mx-5",color:"white"})):B("",!0),e(H,null,{default:t(()=>[s("div",kl,[s("div",{class:fe(`tracker-${a(Y)[P.status].toLowerCase()}`)},[e(Ke,{class:"text-break text-wrap"},{default:t(()=>[p(l(P.url),1)]),_:2},1024),e(ke,{class:"d-block"},{default:t(()=>[P.msg?(i(),h("div",wl,l(P.msg),1)):(i(),h("div",Dl,l($(P.status)),1)),P.tier>=0?(i(),h("div",bl,l(a(d)("torrentDetail.trackers.tier",P.tier)),1)):B("",!0),P.status!==a(Y).NOT_WORKING?(i(),h("div",$l,[s("div",null,l(A(P)),1),s("div",null,"Downloads: "+l(A(P.num_downloaded)),1)])):B("",!0)]),_:2},1024)],2),e(J),P.tier>=0?(i(),h("div",Vl,[e(Ne,{modelValue:_.isVisible,"onUpdate:modelValue":x[4]||(x[4]=M=>_.isVisible=M),"max-width":"750px"},{activator:t(({props:M})=>[e(U,Ie(M,{icon:"mdi-pencil",variant:"text",onClick:Be=>N(P)}),null,16,["onClick"])]),default:t(()=>[e(oe,null,{default:t(()=>[e(we,null,{default:t(()=>[s("span",Tl,l(a(d)("torrentDetail.trackers.editTracker.title")),1)]),_:1}),e(ce,null,{default:t(()=>[e(a(wt),{modelValue:_.isFormValid,"onUpdate:modelValue":x[1]||(x[1]=M=>_.isFormValid=M),onSubmit:x[2]||(x[2]=Oe(()=>{},["prevent"]))},{default:t(()=>[e(a(Ee),{"model-value":_.oldUrl,disabled:"",label:k.$t("torrentDetail.trackers.editTracker.oldUrl")},null,8,["model-value","label"]),e(a(Ee),{modelValue:_.newUrl,"onUpdate:modelValue":x[0]||(x[0]=M=>_.newUrl=M),id:"input",rules:C,label:k.$t("torrentDetail.trackers.editTracker.newUrl"),autofocus:"",onKeydown:Nt(c,["enter"])},null,8,["modelValue","label"])]),_:1},8,["modelValue"])]),_:1}),e(Pe,null,{default:t(()=>[e(J),e(U,{color:"error",disabled:!_.isFormValid,onClick:x[3]||(x[3]=M=>_.isVisible=!1)},{default:t(()=>[p(l(a(d)("common.cancel")),1)]),_:1},8,["disabled"]),e(U,{color:"accent",onClick:c},{default:t(()=>[p(l(a(d)("common.ok")),1)]),_:1})]),_:1})]),_:1})]),_:2},1032,["modelValue"]),e(U,{color:"red",icon:"mdi-delete",variant:"text",onClick:M=>m(P)},null,8,["onClick"])])):B("",!0)])]),_:2},1024)],64))),256)),e(H,null,{default:t(()=>[s("div",{class:fe(["d-flex gap py-5",k.$vuetify.display.mobile?"flex-column":"justify-space-evenly"])},[e(Ne,{modelValue:w.value,"onUpdate:modelValue":x[6]||(x[6]=P=>w.value=P),"max-width":"750px"},{activator:t(({props:P})=>[e(U,Ie(P,{variant:"flat",text:a(d)("torrentDetail.trackers.addTrackers.title"),color:"accent"}),null,16,["text"])]),default:t(()=>[e(oe,null,{default:t(()=>[e(we,null,{default:t(()=>[s("span",Cl,l(a(d)("torrentDetail.trackers.addTrackers.title")),1)]),_:1}),e(ce,null,{default:t(()=>[e(Ye,null,{default:t(()=>[e(I,null,{default:t(()=>[e(T,{cols:"12"},{default:t(()=>[e(qe,{modelValue:f.value,"onUpdate:modelValue":x[5]||(x[5]=P=>f.value=P),label:a(d)("torrentDetail.trackers.addTrackers.newTrackers"),hint:a(d)("torrentDetail.trackers.addTrackers.newTrackersHint")},null,8,["modelValue","label","hint"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Pe,null,{default:t(()=>[e(J),e(U,{color:"error",onClick:o},{default:t(()=>[p(l(a(d)("common.cancel")),1)]),_:1}),e(U,{color:"accent",onClick:r},{default:t(()=>[p(l(a(d)("common.ok")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(U,{variant:"flat",disabled:v.value.length===3,text:a(d)("torrentDetail.trackers.reannounce"),color:"primary",onClick:re},null,8,["disabled","text"])],2)]),_:1})]),_:1}))}}),Nl=pe(Sl,[["__scopeId","data-v-ed947913"]]),Pl={class:"pa-3 text-select"},Ol={style:{"font-size":"1.6em !important"},class:"subtitle-1 ml-2"},Il={class:"d-flex justify-end"},Ll=K({__name:"TorrentDetail",setup(y){const u=Pt(),{t:d}=_e(),g=Ae(),$=He(),A=be(),S=[{text:d("torrentDetail.tabs.overview"),value:"overview"},{text:d("torrentDetail.tabs.info"),value:"info"},{text:d("torrentDetail.tabs.trackers"),value:"trackers"},{text:d("torrentDetail.tabs.peers"),value:"peers"},{text:d("torrentDetail.tabs.content"),value:"content"},{text:d("torrentDetail.tabs.tagsAndCategories"),value:"tagsAndCategories"}],v=O("overview"),f=R(()=>u.currentRoute.value.params.hash),V=R(()=>A.getTorrentByHash(f.value)),w=()=>{u.push({name:"dashboard"})};function C(N){if($.hasActiveDialog)return!1;if(N.key==="Delete")return $.createDialog(bt,{hashes:[f.value]}),N.preventDefault(),!0;N.key==="Escape"&&w()}function _(){const N=u.currentRoute.value.params.tab;N&&(v.value=N)}return Ot(()=>{_()}),xe(()=>{document.addEventListener("keydown",C),_()}),It(()=>{document.removeEventListener("keydown",C)}),(N,b)=>(i(),h(F,null,[s("div",Pl,[e(I,{"no-gutters":"",align:"center",justify:"center"},{default:t(()=>[e(T,null,{default:t(()=>[s("h1",Ol,l(a(d)("torrentDetail.title")),1)]),_:1}),e(T,null,{default:t(()=>[s("div",Il,[e(U,{icon:"mdi-close",variant:"plain",onClick:w})])]),_:1})]),_:1}),e(I,{class:"ma-0 pa-0"},{default:t(()=>[e($t,{modelValue:v.value,"onUpdate:modelValue":b[0]||(b[0]=r=>v.value=r),"bg-color":"primary",grow:"","show-arrows":""},{default:t(()=>[(i(),h(F,null,E(S,({text:r,value:o})=>e(Vt,{value:o,href:`#/torrent/${f.value}/${o}`,text:r},null,8,["value","href","text"])),64))]),_:1},8,["modelValue"])]),_:1}),V.value?(i(),D(Dt,{key:0,modelValue:v.value,"onUpdate:modelValue":b[1]||(b[1]=r=>v.value=r),touch:!1},{default:t(()=>[e(le,{value:"overview"},{default:t(()=>[e(sl,{torrent:V.value,"is-active":v.value==="overview"},null,8,["torrent","is-active"])]),_:1}),e(le,{value:"info"},{default:t(()=>[e(Yt,{torrent:V.value,"is-active":v.value==="info"},null,8,["torrent","is-active"])]),_:1}),e(le,{value:"trackers"},{default:t(()=>[e(Nl,{torrent:V.value,"is-active":v.value==="trackers"},null,8,["torrent","is-active"])]),_:1}),e(le,{value:"peers"},{default:t(()=>[e(hl,{torrent:V.value,"is-active":v.value==="peers"},null,8,["torrent","is-active"])]),_:1}),e(le,{value:"content"},{default:t(()=>[e(a(Mt),{torrent:V.value,"is-active":v.value==="content"},null,8,["torrent","is-active"])]),_:1}),e(le,{value:"tagsAndCategories"},{default:t(()=>[e(yl,{torrent:V.value,"is-active":v.value==="tagsAndCategories"},null,8,["torrent","is-active"])]),_:1})]),_:1},8,["modelValue"])):B("",!0)]),s("div",{style:Xe(`position: absolute; left: ${a(g).rightClickProperties.offset[0]}px; top: ${a(g).rightClickProperties.offset[1]}px;`)},[e(a(nt),{modelValue:a(g).rightClickProperties.isVisible,"onUpdate:modelValue":b[2]||(b[2]=r=>a(g).rightClickProperties.isVisible=r),"menu-data":a(g).menuData},null,8,["modelValue","menu-data"])],4)],64))}});export{Ll as default};

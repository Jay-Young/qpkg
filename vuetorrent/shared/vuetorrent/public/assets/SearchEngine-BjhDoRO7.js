import{j as X,E as Y,f as h,H as E,I as T,J as l,n as e,U as C,L as p,q as ie,u as g,M as R,K as S,P as oe,S as re,$ as ue,c as z,G as ce,v as de,Q as H,F as fe,V as me,O as ge}from"./vue-CfSjRv-x.js";import{a as pe,R as Z,i as A,V as ve,g as M,j as F,c as O,d as he,e as ee,f as Q,h as m,S as le,v as ye,k as Ve,D as ke,E as be,m as Ee,n as Se,p as P,q as we,r as b,G as Ce,U as _e,W as $e,s as G,K as Pe,M as Te,t as J,w as Me,X as Ie,__tla as __tla_0}from"./index-C0tfT_Qc.js";import{_ as W,__tla as __tla_1}from"./MixedButton.vue_vue_type_script_setup_true_lang-Br4NUWtV.js";import"./vuetify-PctCzU6r.js";let je;let __tla=Promise.all([(()=>{try{return __tla_0}catch{}})(),(()=>{try{return __tla_1}catch{}})()]).then(async()=>{let Ne,Ue,De,qe,Le;Ne=["href","title"];Ue=X({__name:"PluginManagerDialog",props:{guid:{}},setup(B){const I=B,{isOpened:t}=pe(I.guid),{t:y}=Y(),c=Z(),d=[{title:y("dialogs.pluginManager.headers.enabled"),key:"enabled",sortable:!1},{title:y("dialogs.pluginManager.headers.name"),key:"fullName"},{title:y("dialogs.pluginManager.headers.version"),key:"version"},{title:y("dialogs.pluginManager.headers.url"),key:"url"},{title:y("dialogs.pluginManager.headers.actions"),key:"actions"}],V=h(!1),k=h(!1),w=h(!1),v=h(!1),u=h("");async function N(r){await c.toggleSearchPlugin(r),await c.fetchSearchPlugins()}async function _(){k.value=!0,await c.updatePlugins().then(()=>new Promise(r=>setTimeout(r,2e3))),await c.fetchSearchPlugins(),k.value=!1}async function U(){$(),V.value=!0,await c.installSearchPlugin(u.value),u.value="",setTimeout(()=>{c.fetchSearchPlugins().then(()=>{V.value=!1})},1e3)}async function D(r){V.value=!0,await c.uninstallSearchPlugin(r.name),await c.fetchSearchPlugins(),V.value=!1}const i=()=>{t.value=!1};function $(){w.value=!1}return(r,f)=>(E(),T(F,{modelValue:g(t),"onUpdate:modelValue":f[4]||(f[4]=n=>oe(t)?t.value=n:null)},{default:l(()=>[e(A,null,{default:l(()=>[e(ve,{class:"d-flex"},{default:l(()=>[C("div",null,p(r.$t("dialogs.pluginManager.title")),1),e(M),e(W,{icon:"mdi-update",text:r.$t("dialogs.pluginManager.update"),color:"accent",class:"mr-2",loading:k.value,onClick:_},null,8,["text","loading"]),e(F,{modelValue:w.value,"onUpdate:modelValue":f[3]||(f[3]=n=>w.value=n)},{activator:l(({props:n})=>[e(W,ie({icon:"mdi-toy-brick-plus",text:r.$t("dialogs.pluginManager.install.activator")},n,{color:"primary"}),null,16,["text"])]),default:l(()=>[e(A,{title:r.$t("dialogs.pluginManager.install.title")},{default:l(()=>[e(O,null,{default:l(()=>[e(g(he),{modelValue:v.value,"onUpdate:modelValue":f[1]||(f[1]=n=>v.value=n),onSubmit:f[2]||(f[2]=R(()=>{},["prevent"]))},{default:l(()=>[e(ee,{modelValue:u.value,"onUpdate:modelValue":f[0]||(f[0]=n=>u.value=n),autofocus:"",label:r.$t("dialogs.pluginManager.install.label")},null,8,["modelValue","label"])]),_:1},8,["modelValue"])]),_:1}),e(Q,null,{default:l(()=>[e(M),e(m,{color:"error",onClick:$},{default:l(()=>[S(p(r.$t("common.cancel")),1)]),_:1}),e(m,{color:"accent",onClick:U},{default:l(()=>[S(p(r.$t("common.ok")),1)]),_:1})]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])]),_:1}),e(O,null,{default:l(()=>[e(le,{mobile:null,headers:d,"items-per-page":"-1",items:g(c).searchPlugins,"sort-by":[{key:"fullName",order:"asc"}],loading:V.value},{"item.enabled":l(({item:n})=>[e(ye,{"model-value":n.enabled,onClick:q=>N(n)},null,8,["model-value","onClick"])]),"item.url":l(({item:n})=>[C("a",{href:n.url,title:n.name},p(n.url),9,Ne)]),"item.actions":l(({item:n})=>[e(Ve,{color:"red",icon:"mdi-delete",onClick:q=>D(n)},null,8,["onClick"])]),_:2},1032,["items","loading"])]),_:1}),e(Q,null,{default:l(()=>[e(M),e(m,{color:"accent",onClick:i},{default:l(()=>[S(p(r.$t("common.close")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}});De={class:"pa-3"};qe={style:{"font-size":"1.6em !important"},class:"subtitle-1 ml-2"};Le={class:"d-flex justify-end"};je=X({__name:"SearchEngine",setup(B){const I=re(),{t}=Y(),y=ke(),c=be(),d=Z(),V=Ee(),k=h(),w=h(!1),v=h(0),{searchData:u}=ue(d),N=[{title:t("searchEngine.headers.fileName"),key:"fileName"},{title:t("searchEngine.headers.fileSize"),key:"fileSize"},{title:t("searchEngine.headers.nbSeeders"),key:"nbSeeders"},{title:t("searchEngine.headers.nbLeechers"),key:"nbLeechers"},{title:t("searchEngine.headers.siteUrl"),key:"siteUrl"},{title:"",key:"actions",sortable:!1}],_=[{title:t("searchEngine.filters.category.movies"),value:"movies"},{title:t("searchEngine.filters.category.tv"),value:"tv"},{title:t("searchEngine.filters.category.music"),value:"music"},{title:t("searchEngine.filters.category.games"),value:"games"},{title:t("searchEngine.filters.category.anime"),value:"anime"},{title:t("searchEngine.filters.category.software"),value:"software"},{title:t("searchEngine.filters.category.pictures"),value:"pictures"},{title:t("searchEngine.filters.category.books"),value:"books"}];_.sort((a,o)=>a.title.localeCompare(o.title));const U=[{title:t("searchEngine.filters.category.all"),value:"all"},..._],D=z(()=>{const a=[{title:t("searchEngine.filters.plugins.all"),value:"all"},{title:t("searchEngine.filters.plugins.enabled"),value:"enabled"}];return d.searchPlugins.filter(o=>o.enabled).forEach(o=>{a.push({title:o.name,value:o.name})}),a}),i=z(()=>u.value[v.value]??{}),{results:$}=Se(()=>i.value.results,()=>i.value.filters?.title,a=>a.fileName);function r(){d.createNewTab(),v.value=u.value.length-1,k.value?.focus()}function f(){u.value.length!==1&&(d.deleteTab(i.value.uniqueId),v.value=Math.min(v.value,u.value.length-1))}function n(a){y.pushTorrentToQueue(a.fileUrl)}function q(a){window.open(a.descrLink,"_blank","noreferrer")}async function x(){await d.runNewSearch(i.value),i.value.timer=setInterval(()=>te(i.value),1e3),k.value?.saveValueToHistory()}async function L(a){await d.stopSearch(a),a.timer&&clearInterval(a.timer)}function ae(){u.value.forEach(L)}async function te(a){await d.refreshResults(a)==="Stopped"&&await L(a)}const K=()=>{I.push({name:"dashboard"})};function ne(){c.createDialog(Ue)}function j(a){if(c.hasActiveDialog||w.value)return!1;a.key==="Escape"&&K()}return ce(async()=>{document.addEventListener("keydown",j),u.value.length===0?d.createNewTab():u.value.forEach(a=>{a.id&&a.id!==0&&(a.timer=setInterval(()=>d.refreshResults(a),1e3))}),await d.fetchSearchPlugins()}),de(()=>{document.removeEventListener("keydown",j),u.value.forEach(a=>{a.timer&&clearInterval(a.timer)})}),(a,o)=>(E(),H("div",De,[e(P,{"no-gutters":"",align:"center",justify:"center"},{default:l(()=>[e(b,null,{default:l(()=>[C("h1",qe,p(g(t)("searchEngine.title")),1)]),_:1}),e(b,null,{default:l(()=>[C("div",Le,[e(m,{icon:"mdi-stop",variant:"plain",color:"error",onClick:ae}),e(m,{icon:"mdi-toy-brick",variant:"plain",color:"primary",onClick:ne}),e(m,{icon:"mdi-close",variant:"plain",onClick:K})])]),_:1})]),_:1}),e(P,{class:"ma-0 pa-0"},{default:l(()=>[e(Ce,{class:"d-flex align-center justify-center ma-0 pa-0 bg-primary",fluid:""},{default:l(()=>[e(_e,{modelValue:v.value,"onUpdate:modelValue":o[0]||(o[0]=s=>v.value=s),class:"overflow-auto","bg-color":"primary","show-arrows":""},{default:l(()=>[(E(!0),H(fe,null,me(g(u),s=>(E(),T($e,{key:s.uniqueId},{default:l(()=>[C("h4",null,p(!s.query||s.query.length===0?a.$t("searchEngine.tabHeaderEmpty"):s.query),1)]),_:2},1024))),128))]),_:1},8,["modelValue"]),e(M),e(m,{icon:"mdi-plus-circle-outline",variant:"plain",color:"accent",onClick:r}),e(m,{icon:"mdi-minus-circle-outline",variant:"plain",color:"error",disabled:g(u).length===1,onClick:f},null,8,["disabled"])]),_:1})]),_:1}),e(we,null,{default:l(()=>[e(G,null,{default:l(()=>[e(P,{class:"mt-1"},{default:l(()=>[e(b,{cols:"12",md:"6"},{default:l(()=>[e(Pe,{modelValue:i.value.query,"onUpdate:modelValue":o[1]||(o[1]=s=>i.value.query=s),"history-key":g(Te).SEARCH_ENGINE_QUERY,ref_key:"queryInput",ref:k,autofocus:"",density:"compact","hide-details":"",clearable:"",label:a.$t("searchEngine.query"),onKeydown:ge(R(x,["prevent"]),["enter"])},null,8,["modelValue","history-key","label","onKeydown"])]),_:1}),e(b,{cols:"6",sm:"5",md:"2"},{default:l(()=>[e(J,{modelValue:i.value.filters.category,"onUpdate:modelValue":o[2]||(o[2]=s=>i.value.filters.category=s),height:"1",variant:"outlined",density:"compact","hide-details":"",items:U,label:a.$t("searchEngine.filters.category.label")},null,8,["modelValue","label"])]),_:1}),e(b,{cols:"6",sm:"5",md:"2"},{default:l(()=>[e(J,{modelValue:i.value.filters.plugin,"onUpdate:modelValue":o[3]||(o[3]=s=>i.value.filters.plugin=s),flat:"",density:"compact","hide-details":"",variant:"outlined",items:D.value,label:a.$t("searchEngine.filters.plugins.label")},null,8,["modelValue","items","label"])]),_:1}),e(b,{cols:"12",sm:"2",class:"d-flex align-center justify-center"},{default:l(()=>[i.value.id===0?(E(),T(m,{key:0,color:"accent",flat:"",class:"mx-auto px-4",onClick:x},{default:l(()=>[S(p(a.$t("searchEngine.runSearch")),1)]),_:1})):(E(),T(m,{key:1,color:"warning",flat:"",class:"mx-auto px-4",onClick:o[4]||(o[4]=s=>L(i.value))},{default:l(()=>[S(p(a.$t("searchEngine.stopSearch")),1)]),_:1}))]),_:1})]),_:1})]),_:1}),e(Me,{class:"my-3"}),e(G,{class:"text-select"},{default:l(()=>[e(le,{mobile:null,headers:N,items:g($),"footer-props":{itemsPerPageOptions:[10,25,50,100,-1]},"items-per-page":i.value.itemsPerPage},{top:l(()=>[e(P,null,{default:l(()=>[e(b,{cols:"12"},{default:l(()=>[e(ee,{modelValue:i.value.filters.title,"onUpdate:modelValue":o[5]||(o[5]=s=>i.value.filters.title=s),density:"compact","hide-details":"",label:a.$t("searchEngine.filters.title.label")},null,8,["modelValue","label"])]),_:1})]),_:1})]),"item.fileSize":l(({item:s})=>[S(p(g(Ie)(s.fileSize,g(V).useBinarySize)),1)]),"item.actions":l(({item:s})=>[e(m,{icon:"mdi-open-in-new",variant:"flat",density:"compact",onClick:R(se=>q(s),["stop"])},null,8,["onClick"]),e(m,{icon:"mdi-download",variant:"flat",density:"compact",onClick:se=>n(s)},null,8,["onClick"])]),_:2},1032,["items","items-per-page"])]),_:1})]),_:1})]))}})});export{je as default,__tla};
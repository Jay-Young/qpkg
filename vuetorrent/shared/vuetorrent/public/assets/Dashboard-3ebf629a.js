import{d as L,$ as c,a2 as w,a7 as p,Z as m,V as I,c as D,a0 as C,a1 as a,F as J,a3 as ae,u as r,j as t,R as Ze,m as R,a5 as Ke,ab as Qe,a4 as O,ac as He,ad as ze,e as E,r as qe,L as me,x as Ge,Y as H,ai as ue,B as te,_ as je,aj as et,ak as tt,a9 as at,k as ot,q as lt,al as nt,A as Me,M as Te,O as Ve}from"./vue-cd4a4a73.js";import{V as Re,_ as Ce,u as oe,f as st,a as rt,T as A,b as it,c as dt,d as ut,e as ct,g as ce,h as W,i as Ye,j as pe,k as z,l as Be,D as U,m as $e,n as ve,o as Xe,p as De,q as ee,r as Ie,s as Le,t as Ee,v as q,w as Pe,x as P,y as Ae,z as mt,A as we,B as Se,C as de,E as xe,F as Je,G as pt,H as K,I as We,J as Ne,K as vt,L as ht,M as Fe}from"./index-952c55ec.js";import{_ as _t}from"./MoveTorrentDialog.vue_vue_type_script_setup_true_lang-1a189e08.js";import{d as Ue}from"./dayjs.min-b02eded3.js";import"./faker-e2f6ff92.js";import{u as ft}from"./ArrayPagination-e283c136.js";import{d as bt}from"./index-eafc4f40.js";import{ac as gt}from"./vuetify-102fadec.js";const yt={class:"d-flex flex-column"},kt={class:"text-caption text-grey"},Tt={class:"text-caption text-grey"},Vt=L({__name:"ItemAmount",props:{torrent:{},title:{},value:{},total:{}},setup(k){return(e,n)=>(c(),w("div",yt,[p("div",kt,m(e.$t(`torrent.properties.${e.title}`)),1),p("div",null,[I(m(e.torrent[e.value])+" ",1),p("span",Tt," / "+m(e.torrent[e.total]),1)])]))}}),$t={class:"d-flex flex-column"},wt={class:"text-caption text-grey"},xt={class:"d-flex flex-row gap"},Bt=L({__name:"ItemChip",props:{torrent:{},title:{},value:{},color:{}},setup(k){const e=k,n=D(()=>{const i=e.torrent[e.value],o=typeof i;if(o==="string")return i.length>0?[i]:[];if(o==="object")return i});return(i,o)=>(c(),w("div",$t,[p("div",wt,m(i.$t(`torrent.properties.${i.title}`)),1),p("div",xt,[!n.value||n.value.length<1?(c(),C(Re,{key:0,color:i.color.replace("$1",i.torrent[i.value]),variant:"flat"},{default:a(()=>[I(m(i.$t(`torrent.properties.empty_${i.value}`)),1)]),_:1},8,["color"])):(c(!0),w(J,{key:1},ae(n.value,T=>(c(),C(Re,{color:i.color.replace("$1",i.torrent.state),variant:"flat"},{default:a(()=>[I(m(T),1)]),_:2},1032,["color"]))),256))])]))}});const St=Ce(Bt,[["__scopeId","data-v-8eb4906a"]]),Ct={class:"d-flex flex-column"},Dt={class:"text-caption text-grey"},It={class:"text-caption text-grey"},Lt=L({__name:"ItemData",props:{torrent:{},title:{},value:{}},setup(k){const e=oe();return(n,i)=>(c(),w("div",Ct,[p("div",Dt,m(n.$t(`torrent.properties.${n.title}`)),1),p("div",null,[I(m(r(st)(n.torrent[n.value],r(e).useBinarySize))+" ",1),p("span",It,m(r(rt)(n.torrent[n.value],r(e).useBinarySize)),1)])]))}}),Et={class:"d-flex flex-column"},Pt={class:"text-caption text-grey"},At={key:0},Ut={key:1},Mt=L({__name:"ItemDateTime",props:{torrent:{},title:{},value:{}},setup(k){const e=oe();return(n,i)=>(c(),w("div",Et,[p("div",Pt,m(n.$t(`torrent.properties.${n.title}`)),1),p("div",null,[n.torrent[n.value]>0?(c(),w("span",At,m(r(Ue)(n.torrent[n.value]*1e3).format(r(e).dateFormat??"DD/MM/YYYY, HH:mm:ss")),1)):(c(),w("span",Ut,m(n.$t("dashboard.not_complete")),1))])]))}}),Rt={class:"d-flex flex-column"},Nt={class:"text-caption text-grey"},Ft={key:0},Ot={key:1},Kt="D[d] H[h] m[m] s[s]",Ht=L({__name:"ItemDuration",props:{torrent:{},title:{},value:{}},setup(k){return(e,n)=>(c(),w("div",Rt,[p("div",Nt,m(e.$t(`torrent.properties.${e.title}`)),1),p("div",null,[e.torrent[e.value]>0?(c(),w("span",Ft,m(r(Ue).duration(e.torrent[e.value],"seconds").format(Kt)),1)):(c(),w("span",Ot,m(e.$t("dashboard.not_complete")),1))])]))}}),zt={class:"d-flex flex-column"},qt={class:"text-caption text-grey"},Gt=L({__name:"ItemPercent",props:{torrent:{},title:{},value:{}},setup(k){const e=k,n=D(()=>[A.UPLOADING,A.CHECKING_UP,A.FORCED_UP,A.ALLOCATING,A.DOWNLOADING,A.META_DL,A.CHECKING_DL,A.FORCED_DL,A.CHECKING_RESUME_DATA,A.MOVING].includes(e.torrent.state));return(i,o)=>(c(),w("div",zt,[p("div",qt,m(i.$t(`torrent.properties.${i.title}`)),1),t(dt,{"model-value":i.torrent[i.value],max:1,striped:n.value,height:20,color:`torrent-${i.torrent.state}`,rounded:"sm",style:{width:"10em"}},{default:a(()=>[I(m(r(it)(i.torrent[i.value])),1)]),_:1},8,["model-value","striped","color"])]))}}),jt={class:"d-flex flex-column"},Yt={class:"text-caption text-grey"},Xt=L({__name:"ItemRelativeTime",props:{torrent:{},title:{},value:{}},setup(k){return(e,n)=>(c(),w("div",jt,[p("div",Yt,m(e.$t(`torrent.properties.${e.title}`)),1),p("div",null,[p("span",null,m(r(Ue)(e.torrent[e.value]*1e3).fromNow()),1)])]))}}),Jt={class:"d-flex flex-column"},Wt={class:"text-caption text-grey"},Zt={class:"text-caption text-grey"},Qt=L({__name:"ItemSpeed",props:{torrent:{},title:{},value:{}},setup(k){const e=oe();return(n,i)=>(c(),w("div",Jt,[p("div",Wt,m(n.$t(`torrent.properties.${n.title}`)),1),p("div",null,[I(m(r(ut)(n.torrent[n.value],r(e).useBitSpeed))+" ",1),p("span",Zt,m(r(ct)(n.torrent[n.value],r(e).useBitSpeed)),1)])]))}}),ea={class:"d-flex flex-column"},ta={class:"text-caption text-grey"},aa=L({__name:"ItemText",props:{torrent:{},title:{},value:{}},setup(k){return(e,n)=>(c(),w("div",ea,[p("div",ta,m(e.$t(`torrent.properties.${e.title}`)),1),p("div",null,m(e.torrent[e.value]),1)]))}}),oa={class:"d-flex gap flex-wrap"},la=L({__name:"Torrent",props:{torrent:{}},setup(k){const e=k,n=ce(),i=W(),o=oe(),T=D(()=>(e.torrent.progress===1?o.doneTorrentProperties:o.busyTorrentProperties).filter(b=>b.active).sort((b,x)=>b.order-x.order));function V(f){f.shiftKey?n.spanTorrentSelection(i.getTorrentIndexByHash(e.torrent.hash)):(Be(f)||n.isSelectionMultiple)&&(n.isSelectionMultiple=!0,n.toggleSelect(e.torrent.hash))}const g=f=>{switch(f){case U.AMOUNT:return Vt;case U.CHIP:return St;case U.DATA:return Lt;case U.DATETIME:return Mt;case U.DURATION:return Ht;case U.PERCENT:return Gt;case U.RELATIVE:return Xt;case U.SPEED:return Qt;case U.TEXT:default:return aa}},l=D(()=>n.isTorrentInSelection(e.torrent.hash));return(f,b)=>(c(),C(z,{class:Ke(`sideborder ${f.torrent.state} pointer`),color:l.value?`torrent-${f.torrent.state}-darken-3`:void 0,width:"100%",onClick:V},{default:a(()=>[t(Ye,{class:"font-weight-bold text-wrap"},{default:a(()=>[I(m(f.torrent.name),1)]),_:1}),t(pe,null,{default:a(()=>[p("div",oa,[(c(!0),w(J,null,ae(T.value,x=>(c(),C(Ze(g(x.type)),R({torrent:f.torrent},x.props),null,16,["torrent"]))),256))])]),_:1})]),_:1},8,["class","color"]))}});const na=Ce(la,[["__scopeId","data-v-43ae49b8"]]),sa={class:"d-flex"},ra={key:2},ia={key:3},da=L({__name:"RightClickMenuEntry",props:{text:{},icon:{},action:{type:Function},hidden:{type:Boolean},disabled:{type:Boolean},disabledText:{},disabledIcon:{},divider:{type:Boolean},children:{}},setup(k){return(e,n)=>{const i=Qe("RightClickMenuEntry",!0);return e.hidden?O("",!0):(c(),C(ee,{key:0,class:"px-3 pointer",disabled:e.disabled,onClick:e.action},{default:a(()=>[p("div",sa,[e.disabled&&e.disabledIcon?(c(),C($e,{key:0,class:"mr-2"},{default:a(()=>[I(m(e.disabledIcon),1)]),_:1})):e.icon?(c(),C($e,{key:1,class:"mr-2"},{default:a(()=>[I(m(e.icon),1)]),_:1})):O("",!0),e.disabled&&e.disabledText?(c(),w("span",ra,m(e.disabledText),1)):(c(),w("span",ia,m(e.text),1)),t(ve),e.children?(c(),C($e,{key:4},{default:a(()=>[I("mdi-chevron-right")]),_:1})):O("",!0)]),e.children?(c(),C(Xe,{key:0,activator:"parent","open-on-hover":!0,"open-on-click":!0,"close-delay":"0","open-delay":"0",location:"right"},{default:a(()=>[t(De,null,{default:a(()=>[(c(!0),w(J,null,ae(e.children,o=>(c(),C(i,He(ze(o)),null,16))),256))]),_:1})]),_:1})):O("",!0)]),_:1},8,["disabled","onClick"]))}}}),ua=L({__name:"RenameTorrentDialog",props:{guid:{},hash:{}},setup(k){const e=k,{isOpened:n}=Ie(e.guid),{t:i}=Le(),o=W(),T=E(),V=E(),g=E(!1),l=qe({newName:""}),f=[$=>!!$||i("dialogs.renameTorrent.required"),$=>$!==x.value||i("dialogs.renameTorrent.sameName")],b=D(()=>o.getTorrentByHash(e.hash)),x=D(()=>b.value?.name);async function h(){await V.value?.validate(),g.value&&(await o.renameTorrent(e.hash,l.newName),B())}const B=()=>{n.value=!1};return me(()=>{l.newName=b.value?.name||""}),Ge(()=>{T.value?.select()}),($,_)=>(c(),C(Ae,{modelValue:r(n),"onUpdate:modelValue":_[3]||(_[3]=d=>te(n)?n.value=d:null)},{default:a(()=>[t(z,null,{default:a(()=>[t(Ye,null,{default:a(()=>[I(m($.$t("dialogs.renameTorrent.title")),1)]),_:1}),t(pe,null,{default:a(()=>[t(r(Ee),{modelValue:g.value,"onUpdate:modelValue":_[1]||(_[1]=d=>g.value=d),ref_key:"form",ref:V,onSubmit:_[2]||(_[2]=H(()=>{},["prevent"]))},{default:a(()=>[x.value?(c(),C(q,{key:0,"model-value":x.value,disabled:"",label:$.$t("dialogs.renameTorrent.oldName")},null,8,["model-value","label"])):O("",!0),t(q,{modelValue:l.newName,"onUpdate:modelValue":_[0]||(_[0]=d=>l.newName=d),ref_key:"field",ref:T,rules:f,autofocus:"",label:$.$t("dialogs.renameTorrent.newName"),onKeydown:ue(h,["enter"])},null,8,["modelValue","label","onKeydown"])]),_:1},8,["modelValue"])]),_:1}),t(Pe,null,{default:a(()=>[t(ve),t(P,{color:"error",onClick:B},{default:a(()=>[I(m($.$t("common.cancel")),1)]),_:1}),t(P,{color:"accent",disabled:!g.value,onClick:h},{default:a(()=>[I(m($.$t("common.save")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),X=-2,M=-1,ca=L({__name:"ShareLimitDialog",props:{guid:{},hash:{}},setup(k){const e=k,{isOpened:n}=Ie(e.guid),i=W(),o=E(!1),T=E("global"),V=E(!1),g=E(0),l=E(!1),f=E(0),b=E(!1),x=E(0),h=D(()=>T.value!=="enabled");function B(){n.value=!1}async function $(){switch(T.value){case"global":await i.setShareLimit([e.hash],X,X,X);break;case"disabled":await i.setShareLimit([e.hash],M,M,M);break;case"enabled":await i.setShareLimit([e.hash],V.value?g.value:M,l.value?f.value:M,b.value?x.value:M);break}B()}return me(async()=>{const _=i.getTorrentByHash(e.hash);if(!_)return B();const d=_.ratio_limit,y=_.seeding_time_limit,N=_.inactive_seeding_time_limit;d===X&&y===X&&N===X?T.value="global":d===M&&y===M&&N===M?T.value="disabled":(T.value="enabled",V.value=d>=0,g.value=V.value?d:0,l.value=y>=0,f.value=l.value?y:0,b.value=N>=0,x.value=b.value?N:0)}),(_,d)=>(c(),C(Ae,{modelValue:r(n),"onUpdate:modelValue":d[9]||(d[9]=y=>te(n)?n.value=y:null),"max-width":"500"},{default:a(()=>[t(z,{title:_.$t("dialogs.share_limit.title")},{default:a(()=>[t(pe,null,{default:a(()=>[t(Ee,{modelValue:o.value,"onUpdate:modelValue":d[7]||(d[7]=y=>o.value=y),onSubmit:d[8]||(d[8]=H(()=>{},["prevent"])),onKeydown:ue(H($,["prevent"]),["enter"])},{default:a(()=>[t(mt,{modelValue:T.value,"onUpdate:modelValue":d[0]||(d[0]=y=>T.value=y)},{default:a(()=>[t(we,{label:_.$t("dialogs.share_limit.global"),value:"global"},null,8,["label"]),t(we,{label:_.$t("dialogs.share_limit.disabled"),value:"disabled"},null,8,["label"]),t(we,{label:_.$t("dialogs.share_limit.enabled"),value:"enabled"},null,8,["label"])]),_:1},8,["modelValue"]),t(Se,null,{default:a(()=>[t(de,{cols:"12",class:"d-flex align-center"},{default:a(()=>[p("span",null,[t(xe,{modelValue:V.value,"onUpdate:modelValue":d[1]||(d[1]=y=>V.value=y),disabled:h.value},null,8,["modelValue","disabled"])]),t(q,{modelValue:g.value,"onUpdate:modelValue":d[2]||(d[2]=y=>g.value=y),disabled:h.value||!V.value,density:"compact","hide-details":"",label:_.$t("dialogs.share_limit.ratio_limit")},null,8,["modelValue","disabled","label"])]),_:1}),t(de,{cols:"12",class:"d-flex align-center"},{default:a(()=>[p("span",null,[t(xe,{modelValue:l.value,"onUpdate:modelValue":d[3]||(d[3]=y=>l.value=y),disabled:h.value},null,8,["modelValue","disabled"])]),t(q,{modelValue:f.value,"onUpdate:modelValue":d[4]||(d[4]=y=>f.value=y),disabled:h.value||!l.value,density:"compact","hide-details":"",label:_.$t("dialogs.share_limit.seeding_time_limit")},null,8,["modelValue","disabled","label"])]),_:1}),t(de,{cols:"12",class:"d-flex align-center"},{default:a(()=>[p("span",null,[t(xe,{modelValue:b.value,"onUpdate:modelValue":d[5]||(d[5]=y=>b.value=y),disabled:h.value},null,8,["modelValue","disabled"])]),t(q,{modelValue:x.value,"onUpdate:modelValue":d[6]||(d[6]=y=>x.value=y),disabled:h.value||!b.value,density:"compact","hide-details":"",label:_.$t("dialogs.share_limit.inactive_seeding_time_limit")},null,8,["modelValue","disabled","label"])]),_:1})]),_:1})]),_:1},8,["modelValue","onKeydown"])]),_:1}),t(Pe,null,{default:a(()=>[t(ve),t(P,{color:"error",onClick:B},{default:a(()=>[I(m(_.$t("common.cancel")),1)]),_:1}),t(P,{color:"accent",disabled:!o.value,onClick:$},{default:a(()=>[I(m(_.$t("common.save")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"]))}}),Oe=L({__name:"SpeedLimitDialog",props:{guid:{},hash:{},mode:{}},setup(k){const e=k,{isOpened:n}=Ie(e.guid),i=W(),o=E(!1),T=E(0);function V(){n.value=!1}async function g(){const l=Math.max(0,T.value)*1e3;switch(e.mode){case"download":await i.setDownloadLimit(l,[e.hash]);break;case"upload":await i.setUploadLimit(l,[e.hash]);break}V()}return me(async()=>{const l=i.getTorrentByHash(e.hash);if(!l)return V();switch(e.mode){case"download":T.value=Math.max(0,Math.round(l.dl_limit/1e3));break;case"upload":T.value=Math.max(0,Math.round(l.up_limit/1e3));break}}),(l,f)=>(c(),C(Ae,{modelValue:r(n),"onUpdate:modelValue":f[3]||(f[3]=b=>te(n)?n.value=b:null)},{default:a(()=>[t(z,{title:l.$t(`dialogs.speed_limit.${l.mode}`)},{default:a(()=>[t(pe,null,{default:a(()=>[t(Ee,{modelValue:o.value,"onUpdate:modelValue":f[1]||(f[1]=b=>o.value=b),onSubmit:f[2]||(f[2]=H(()=>{},["prevent"])),onKeydown:ue(H(g,["prevent"]),["enter"])},{default:a(()=>[t(q,{modelValue:T.value,"onUpdate:modelValue":f[0]||(f[0]=b=>T.value=b),type:"number",autofocus:"",clearable:"",label:l.$t("dialogs.speed_limit.label"),"prepend-inner-icon":"mdi-speedometer",suffix:"kB/s",onKeydown:ue(H(g,["prevent"]),["enter"])},null,8,["modelValue","label","onKeydown"])]),_:1},8,["modelValue","onKeydown"])]),_:1}),t(Pe,null,{default:a(()=>[t(ve),t(P,{color:"error",onClick:V},{default:a(()=>[I(m(l.$t("common.cancel")),1)]),_:1}),t(P,{color:"accent",disabled:!o.value,onClick:g},{default:a(()=>[I(m(l.$t("common.save")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"]))}}),he=k=>(et("data-v-18d5c938"),k=k(),tt(),k),ma={class:"d-flex justify-space-around"},pa=he(()=>p("span",null,"Resume",-1)),va=he(()=>p("span",null,"Force Resume",-1)),ha=he(()=>p("span",null,"Pause",-1)),_a=he(()=>p("span",null,"Delete",-1)),fa=L({__name:"RightClickMenu",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(k,{emit:e}){const n=k,i=e,{t:o}=Le(),T=je(),V=ce(),g=Je(),l=W(),f=pt(),b=D({get:()=>n.modelValue,set:s=>i("update:modelValue",s)}),x=D(()=>V.selectedTorrents.length>1),h=D(()=>V.selectedTorrents),B=D(()=>h.value[0]),$=D(()=>l.getTorrentByHash(B.value)),_=D(()=>V.selectedTorrents.map(l.getTorrentByHash).filter(s=>!!s)),d=D(()=>[{name:""},...l.categories]);async function y(){await l.resumeTorrents(h)}async function N(){await l.forceResumeTorrents(h)}async function F(){await l.pauseTorrents(h)}function le(){g.createDialog(We,{hashes:[...V.selectedTorrents]})}function _e(){g.createDialog(_t,{hashes:[...V.selectedTorrents]})}function ne(){g.createDialog(ua,{hash:V.selectedTorrents[0]})}async function G(){await l.recheckTorrents(h)}async function fe(){await l.reannounceTorrents(h)}async function be(){await l.toggleSeqDl(h)}async function ge(){await l.toggleFLPiecePrio(h)}async function Z(){await l.toggleAutoTmm(h,!$.value?.auto_tmm)}function se(s){return _.value.every(u=>u&&u.tags&&u.tags.includes(s))}async function ye(s){se(s)?await l.removeTorrentTags(h.value,[s]):await l.addTorrentTags(h.value,[s])}async function j(s){await navigator.clipboard.writeText(s)}function re(){g.createDialog(Oe,{hash:B.value,mode:"download"})}function ie(){g.createDialog(Oe,{hash:B.value,mode:"upload"})}function ke(){g.createDialog(ca,{hash:B.value})}async function Q(){h.value.forEach(s=>{l.exportTorrent(s).then(u=>{const S=window.URL.createObjectURL(u),Y=document.createElement("a");Y.href=S,Y.style.opacity="0",Y.setAttribute("download",`${s}.torrent`),document.body.appendChild(Y),Y.click(),document.body.removeChild(Y)})})}const v=D(()=>[{text:o("dashboard.right_click.advanced.title"),icon:"mdi-head-cog",children:[{text:o("dashboard.right_click.advanced.change_location"),icon:"mdi-folder",action:_e},{text:o("dashboard.right_click.advanced.rename"),icon:"mdi-rename-box",hidden:x.value,action:ne},{text:o("dashboard.right_click.advanced.recheck"),icon:"mdi-playlist-check",action:G},{text:o("dashboard.right_click.advanced.reannounce"),icon:"mdi-bullhorn",action:fe},{text:o("dashboard.right_click.advanced.seq_dl"),icon:$.value?.seq_dl?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",action:be},{text:o("dashboard.right_click.advanced.f_l_prio"),icon:$.value?.f_l_piece_prio?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",action:ge},{text:o("dashboard.right_click.advanced.auto_tmm"),icon:$.value?.auto_tmm?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",action:Z}]},{text:o("dashboard.right_click.priority.title"),icon:"mdi-priority-high",hidden:!f.preferences.queueing_enabled,children:[{text:o("dashboard.right_click.priority.top"),icon:"mdi-priority-high",action:async()=>await l.setTorrentPriority(h.value,"topPrio")},{text:o("dashboard.right_click.priority.increase"),icon:"mdi-arrow-up",action:async()=>await l.setTorrentPriority(h.value,"increasePrio")},{text:o("dashboard.right_click.priority.decrease"),icon:"mdi-arrow-down",action:async()=>await l.setTorrentPriority(h.value,"decreasePrio")},{text:o("dashboard.right_click.priority.bottom"),icon:"mdi-priority-low",action:async()=>await l.setTorrentPriority(h.value,"bottomPrio")}]},{text:o("dashboard.right_click.tags.title"),icon:"mdi-tag",disabled:l.tags.length===0,disabledText:o("dashboard.right_click.tags.disabled_title"),disabledIcon:"mdi-tag-off",children:l.tags.map(s=>({text:s,icon:se(s)?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",action:async()=>await ye(s)}))},{text:o("dashboard.right_click.category.title"),icon:"mdi-label",disabled:l.categories.length===0,disabledText:o("dashboard.right_click.category.disabled_title"),disabledIcon:"mdi-label-off",children:d.value.map(s=>({text:s.name===""?o("dashboard.right_click.category.clear"):s.name,action:async()=>await l.setTorrentCategory(h.value,s.name)}))},{text:o("dashboard.right_click.speed_limit.title"),icon:"mdi-speedometer-slow",children:[{text:o("dashboard.right_click.speed_limit.download"),icon:"mdi-download",action:re},{text:o("dashboard.right_click.speed_limit.upload"),icon:"mdi-upload",action:ie},{text:o("dashboard.right_click.speed_limit.share"),icon:"mdi-account-group",action:ke}]},{text:o("dashboard.right_click.copy.title"),icon:"mdi-content-copy",hidden:x.value,children:[{text:o("dashboard.right_click.copy.name"),icon:"mdi-alphabetical-variant",action:async()=>$.value&&await j($.value.name)},{text:o("dashboard.right_click.copy.hash"),icon:"mdi-pound",action:async()=>await j(B.value)},{text:o("dashboard.right_click.copy.magnet"),icon:"mdi-magnet",action:async()=>$.value&&await j($.value.magnet)}]},{text:o("dashboard.right_click.export",V.selectedTorrents.length),icon:x.value?"mdi-download-multiple":"mdi-download",action:Q},{text:o("dashboard.right_click.info"),icon:"mdi-information",hidden:x.value,action:()=>T.push({name:"torrentDetail",params:{hash:B.value}})}]);return(s,u)=>b.value?(c(),C(Xe,{key:0,modelValue:b.value,"onUpdate:modelValue":u[0]||(u[0]=S=>b.value=S),activator:"parent","close-on-content-click":!0,transition:"slide-y-transition","scroll-strategy":"none"},{default:a(()=>[t(De,null,{default:a(()=>[t(ee,null,{default:a(()=>[p("div",ma,[t(K,{location:"top"},{activator:a(({props:S})=>[t(P,R({density:"compact",variant:"plain",icon:"mdi-play"},S,{onClick:y}),null,16)]),default:a(()=>[pa]),_:1}),t(K,{location:"top"},{activator:a(({props:S})=>[t(P,R({density:"compact",variant:"plain",icon:"mdi-fast-forward"},S,{onClick:N}),null,16)]),default:a(()=>[va]),_:1}),t(K,{location:"top"},{activator:a(({props:S})=>[t(P,R({density:"compact",variant:"plain",icon:"mdi-pause"},S,{onClick:F}),null,16)]),default:a(()=>[ha]),_:1}),t(K,{location:"top"},{activator:a(({props:S})=>[t(P,R({color:"red",density:"compact",variant:"plain",icon:"mdi-delete-forever"},S,{onClick:le}),null,16)]),default:a(()=>[_a]),_:1})])]),_:1}),(c(!0),w(J,null,ae(v.value,S=>(c(),C(da,He(ze(S)),null,16))),256))]),_:1})]),_:1},8,["modelValue"])):O("",!0)}});const ba=Ce(fa,[["__scopeId","data-v-18d5c938"]]),ga={class:"pt-4 px-1 px-sm-5"},ya={class:"pa-0",style:{width:"10em"}},ka={class:"text-uppercase",style:{float:"right","font-size":"0.8em"}},Ta={class:"text-grey"},Va={key:0,class:"mt-5 text-xs-center"},$a={class:"text-grey"},wa={key:1},xa={class:"d-flex align-center"},Aa=L({__name:"Dashboard",setup(k){const{t:e}=Le(),n=je(),i=gt(),o=ce(),T=Je(),{currentPage:V,filteredTorrents:g,isSelectionMultiple:l,selectedTorrents:f,sortOptions:b,torrentCountString:x}=at(ce()),h=W(),B=oe(),$=[{value:"added_on",title:e("dashboard.sortBy.added_on")},{value:"amount_left",title:e("dashboard.sortBy.amount_left")},{value:"auto_tmm",title:e("dashboard.sortBy.auto_tmm")},{value:"availability",title:e("dashboard.sortBy.availability")},{value:"avg_download_speed",title:e("dashboard.sortBy.avg_download_speed")},{value:"avg_upload_speed",title:e("dashboard.sortBy.avg_upload_speed")},{value:"category",title:e("dashboard.sortBy.category")},{value:"completed",title:e("dashboard.sortBy.completed")},{value:"completion_on",title:e("dashboard.sortBy.completion_on")},{value:"content_path",title:e("dashboard.sortBy.content_path")},{value:"dl_limit",title:e("dashboard.sortBy.dl_limit")},{value:"dlspeed",title:e("dashboard.sortBy.dlspeed")},{value:"download_path",title:e("dashboard.sortBy.download_path")},{value:"downloaded",title:e("dashboard.sortBy.downloaded")},{value:"downloaded_session",title:e("dashboard.sortBy.downloaded_session")},{value:"eta",title:e("dashboard.sortBy.eta")},{value:"f_l_piece_prio",title:e("dashboard.sortBy.f_l_piece_prio")},{value:"force_start",title:e("dashboard.sortBy.force_start")},{value:"globalSpeed",title:e("dashboard.sortBy.globalSpeed")},{value:"globalVolume",title:e("dashboard.sortBy.globalVolume")},{value:"hash",title:e("dashboard.sortBy.hash")},{value:"infohash_v1",title:e("dashboard.sortBy.infohash_v1")},{value:"infohash_v2",title:e("dashboard.sortBy.infohash_v2")},{value:"last_activity",title:e("dashboard.sortBy.last_activity")},{value:"magnet_uri",title:e("dashboard.sortBy.magnet_uri")},{value:"max_ratio",title:e("dashboard.sortBy.max_ratio")},{value:"max_seeding_time",title:e("dashboard.sortBy.max_seeding_time")},{value:"name",title:e("dashboard.sortBy.name")},{value:"num_complete",title:e("dashboard.sortBy.num_complete")},{value:"num_incomplete",title:e("dashboard.sortBy.num_incomplete")},{value:"num_leechs",title:e("dashboard.sortBy.num_leechs")},{value:"num_seeds",title:e("dashboard.sortBy.num_seeds")},{value:"priority",title:e("dashboard.sortBy.priority")},{value:"progress",title:e("dashboard.sortBy.progress")},{value:"ratio",title:e("dashboard.sortBy.ratio")},{value:"ratio_limit",title:e("dashboard.sortBy.ratio_limit")},{value:"save_path",title:e("dashboard.sortBy.save_path")},{value:"seeding_time",title:e("dashboard.sortBy.seeding_time")},{value:"seeding_time_limit",title:e("dashboard.sortBy.seeding_time_limit")},{value:"seen_complete",title:e("dashboard.sortBy.seen_complete")},{value:"seq_dl",title:e("dashboard.sortBy.seq_dl")},{value:"size",title:e("dashboard.sortBy.size")},{value:"state",title:e("dashboard.sortBy.state")},{value:"super_seeding",title:e("dashboard.sortBy.super_seeding")},{value:"tags",title:e("dashboard.sortBy.tags")},{value:"time_active",title:e("dashboard.sortBy.time_active")},{value:"total_size",title:e("dashboard.sortBy.total_size")},{value:"tracker",title:e("dashboard.sortBy.tracker")},{value:"trackers_count",title:e("dashboard.sortBy.trackers_count")},{value:"up_limit",title:e("dashboard.sortBy.up_limit")},{value:"uploaded",title:e("dashboard.sortBy.uploaded")},{value:"uploaded_session",title:e("dashboard.sortBy.uploaded_session")},{value:"upspeed",title:e("dashboard.sortBy.upspeed")}].sort((v,s)=>v.title.localeCompare(s.title));$.splice(0,0,{value:"",title:e("dashboard.sortBy.default")});const _=E(!1),d=qe({isVisible:!1,offset:[0,0]}),y=D({get:()=>h.textFilter,set:bt(v=>{h.textFilter=v},300)}),{paginatedResults:N,currentPage:F,pageCount:le}=ft(g,B.paginationSize,V),_e=D(()=>!!h.textFilter&&h.textFilter.length>0),ne=D(()=>g.value.length<=f.value.length);function G(v){_.value=v??!_.value,_.value&&Me(()=>{document.getElementById("searchInput")?.focus()})}function fe(v){o.toggleSelect(v)}function be(v){l.value||n.push({name:"torrentDetail",params:{hash:v}})}function ge(){h.textFilter=""}function Z(){window.scrollTo({top:0,behavior:"smooth"})}function se(){l.value&&o.unselectAllTorrents(),l.value=!l.value}function ye(){ne.value?o.unselectAllTorrents():o.selectTorrents(...g.value.map(v=>v.hash))}async function j(v,s){v.preventDefault(),d.isVisible&&(d.isVisible=!1,await Me()),d.isVisible=!0,d.offset=[v.pageX,v.pageY],l.value?f.value.length===0&&o.selectTorrent(s.hash):(o.unselectAllTorrents(),o.selectTorrent(s.hash))}ot(()=>d.isVisible,v=>{!v&&!l.value&&o.unselectAllTorrents()});function re(v){if(T.hasActiveDialog)return!1;const s=v.target;if(Be(v)&&v.key==="a"&&s.tagName!=="INPUT")return o.unselectAllTorrents(),o.selectTorrents(...g.value.map(u=>u.hash)),v.preventDefault(),!0;if(Be(v)&&v.key==="f"){const u=document.getElementById("searchInput");if(document.activeElement!==u)return G(!0),v.preventDefault(),!0}if(v.key==="Escape"){const u=document.getElementById("searchInput");return document.activeElement===u||_.value?G(!1):(l.value=!1,o.unselectAllTorrents()),v.preventDefault(),!0}if(v.key==="Delete")return f.value.length===0?void 0:(T.createDialog(We,{hashes:o.selectedTorrents}),v.preventDefault(),!0);if(v.key==="/"){const u=document.getElementById("searchInput");return document.activeElement!==u&&!_.value&&(n.push({name:"searchEngine"}),v.preventDefault()),!0}}me(async()=>{await h.fetchCategories(),await h.fetchTags(),G(_e.value)}),Ge(()=>{document.addEventListener("keydown",re),l.value=!1,Z()}),lt(()=>{document.removeEventListener("keydown",re)});const ie=E();function ke(v,s){ie.value=setTimeout(()=>{j(v,s)},500)}function Q(){clearTimeout(ie.value)}return(v,s)=>(c(),w(J,null,[p("div",ga,[t(Se,{class:"ma-0 pa-0 mb-2"},{default:a(()=>[t(Ne,null,{default:a(()=>[Te(t(z,{color:"transparent"},{default:a(()=>[t(q,{id:"searchInput",modelValue:y.value,"onUpdate:modelValue":s[0]||(s[0]=u=>y.value=u),label:r(e)("dashboard.searchInputLabel"),clearable:"",density:"compact","hide-details":"","prepend-inner-icon":"mdi-magnify",rounded:"pill","single-line":"",style:{width:"200px"},variant:"solo","onClick:clear":s[1]||(s[1]=u=>ge())},null,8,["modelValue","label"])]),_:1},512),[[Ve,_.value]])]),_:1}),t(K,{text:r(e)("dashboard.toggleSearchFilter"),location:"top"},{activator:a(({props:u})=>[t(P,R({icon:_.value?"mdi-chevron-left-circle":"mdi-text-box-search"},u,{variant:"plain",onClick:s[2]||(s[2]=S=>G())}),null,16,["icon"])]),_:1},8,["text"]),t(K,{text:r(e)("dashboard.toggleSelectMode"),location:"top"},{activator:a(({props:u})=>[t(P,R({icon:r(l)?"mdi-checkbox-marked":"mdi-checkbox-blank-outline"},u,{variant:"plain",onClick:se}),null,16,["icon"])]),_:1},8,["text"]),t(K,{text:r(e)("dashboard.toggleSortOrder"),location:"top"},{activator:a(({props:u})=>[t(P,R({icon:r(b).reverseOrder?"mdi-arrow-up-thin":"mdi-arrow-down-thin"},u,{variant:"plain",onClick:s[3]||(s[3]=S=>r(b).reverseOrder=!r(b).reverseOrder)}),null,16,["icon"])]),_:1},8,["text"]),p("div",ya,[t(vt,{modelValue:r(b).sortBy,"onUpdate:modelValue":s[4]||(s[4]=u=>r(b).sortBy=u),items:r($),label:r(e)("dashboard.sortLabel"),"auto-select-first":"",density:"compact","hide-details":"",variant:"solo-filled"},null,8,["modelValue","items","label"])]),t(de,{class:"align-center justify-center"},{default:a(()=>[p("span",ka,m(r(x)),1)]),_:1})]),_:1}),t(Se,{class:"ma-0 pa-0"},{default:a(()=>[t(ht,null,{default:a(()=>[Te(t(z,{color:"transparent"},{default:a(()=>[t(K,{text:r(e)("common.selectAll"),location:"bottom"},{activator:a(({props:u})=>[t(P,R({icon:ne.value?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",class:"text-grey",color:"transparent",style:{left:"-8px"}},u,{onClick:ye}),null,16,["icon"])]),_:1},8,["text"]),p("span",Ta,m(r(e)("dashboard.selectAll")),1)]),_:1},512),[[Ve,r(l)]])]),_:1})]),_:1}),r(o).filteredTorrents.length===0?(c(),w("div",Va,[p("p",$a,m(r(e)("common.emptyList")),1)])):(c(),w("div",wa,[t(De,{id:"torrentList",class:"pa-0",color:"transparent"},{default:a(()=>[r(B).isPaginationOnTop&&!r(B).isInfiniteScrollActive?(c(),C(ee,{key:0},{default:a(()=>[t(Fe,{modelValue:r(F),"onUpdate:modelValue":s[5]||(s[5]=u=>te(F)?F.value=u:null),length:r(le),"next-icon":"mdi-menu-right","prev-icon":"mdi-menu-left",onInput:Z},null,8,["modelValue","length"])]),_:1})):O("",!0),(c(!0),w(J,null,ae(r(N),u=>(c(),C(ee,{id:`torrent-${u.hash}`,class:Ke([r(i).mobile?"mb-2":"mb-4","pa-0"]),onContextmenu:S=>j(S,u),onTouchcancel:Q,onTouchend:Q,onTouchmove:Q,onTouchstart:ke,onDblclick:H(S=>be(u.hash),["prevent"])},{default:a(()=>[p("div",xa,[t(Ne,null,{default:a(()=>[Te(t(z,{class:"mr-3",color:"transparent"},{default:a(()=>[t(P,{icon:r(o).isTorrentInSelection(u.hash)?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",color:"transparent",variant:"flat",onClick:S=>fe(u.hash)},null,8,["icon","onClick"])]),_:2},1536),[[Ve,r(o).isSelectionMultiple]])]),_:2},1024),t(na,{torrent:u},null,8,["torrent"])])]),_:2},1032,["id","class","onContextmenu","onDblclick"]))),256)),!r(B).isPaginationOnTop&&!r(B).isInfiniteScrollActive?(c(),C(ee,{key:1},{default:a(()=>[t(Fe,{modelValue:r(F),"onUpdate:modelValue":s[6]||(s[6]=u=>te(F)?F.value=u:null),length:r(le),"next-icon":"mdi-menu-right","prev-icon":"mdi-menu-left",onInput:Z},null,8,["modelValue","length"])]),_:1})):O("",!0)]),_:1})]))]),p("div",{style:nt(`position: absolute; left: ${d.offset[0]}px; top: ${d.offset[1]}px;`)},[t(ba,{modelValue:d.isVisible,"onUpdate:modelValue":s[7]||(s[7]=u=>d.isVisible=u)},null,8,["modelValue"])],4)],64))}});export{Aa as default};

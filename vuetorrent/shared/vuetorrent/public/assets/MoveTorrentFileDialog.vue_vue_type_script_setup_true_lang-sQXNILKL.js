import{g as D,K as S,d as i,r as B,N as I,A as g,a3 as F,a4 as T,a5 as t,m as l,W as m,Z as f,u as V,Y as h,aa as x,ap as M,D as $}from"./vue-7zd71vkt.js";import{k as K,aM as O,l as U,m as q,n as A,V as b,o as R,f as _,g as C,p as P,q as W}from"./index-z3dneNLh.js";const j=D({__name:"MoveTorrentFileDialog",props:{guid:{},hash:{},isFolder:{type:Boolean},oldName:{}},setup(k){const o=k,{isOpened:r}=K(o.guid),{t:p}=S(),c=O(),N=i(),u=i(),d=i(!1),n=B({newName:""}),y=[e=>!!e||p("dialogs.moveTorrent.required")];async function v(){await N.value?.validate(),d.value&&(o.isFolder?await c.renameTorrentFolder(o.hash,o.oldName,n.newName):await c.renameTorrentFile(o.hash,o.oldName,n.newName),w())}const w=()=>{r.value=!1};return I(()=>{if(n.newName=o.oldName,o.isFolder)g(()=>u.value?.select());else{const e=n.newName.lastIndexOf("/"),a=n.newName.lastIndexOf(".");g(()=>{u.value?.setSelectionRange(e+1,a==-1?n.newName.length:a)})}}),(e,a)=>(F(),T(W,{modelValue:V(r),"onUpdate:modelValue":a[3]||(a[3]=s=>$(r)?r.value=s:null)},{default:t(()=>[l(P,null,{default:t(()=>[l(U,null,{default:t(()=>[m(f(V(p)("dialogs.moveTorrentFile.title",1+Number(e.isFolder))),1)]),_:1}),l(q,null,{default:t(()=>[l(V(A),{modelValue:d.value,"onUpdate:modelValue":a[1]||(a[1]=s=>d.value=s),ref_key:"form",ref:N,onSubmit:a[2]||(a[2]=h(()=>{},["prevent"]))},{default:t(()=>[e.oldName?(F(),T(b,{key:0,"model-value":e.oldName,disabled:"",label:e.$t("dialogs.moveTorrentFile.oldName")},null,8,["model-value","label"])):x("",!0),l(b,{modelValue:n.newName,"onUpdate:modelValue":a[0]||(a[0]=s=>n.newName=s),ref_key:"input",ref:u,rules:y,autofocus:"",label:e.$t("dialogs.moveTorrent.newPath"),onKeydown:M(v,["enter"])},null,8,["modelValue","label"])]),_:1},8,["modelValue"])]),_:1}),l(R,null,{default:t(()=>[l(_),l(C,{color:"error",onClick:w},{default:t(()=>[m(f(e.$t("common.cancel")),1)]),_:1}),l(C,{color:"accent",disabled:!d.value,onClick:v},{default:t(()=>[m(f(e.$t("common.save")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}});export{j as _};

"use strict";/*!--------------------------------------------------------
 * Copyright (C) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------*/(function(){var g=["vs/code/browser/workbench/workbench","require","exports","vs/base/browser/browser","vs/base/common/cancellation","vs/base/common/marshalling","vs/base/common/event","vs/base/common/lifecycle","vs/base/common/network","vs/base/common/resources","vs/base/common/uri","vs/base/parts/request/browser/request","vs/platform/product/common/product","vs/platform/window/common/window","vs/workbench/workbench.web.main","vs/base/common/path","vs/base/common/strings","vs/platform/tunnel/common/tunnel"],$=function(y){for(var p=[],d=0,w=y.length;d<w;d++)p[d]=g[y[d]];return p};define(g[0],$([1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]),function(y,p,d,w,I,b,R,h,v,a,O,U,c,k,u,S,E){"use strict";Object.defineProperty(p,"__esModule",{value:!0});class f{constructor(){let e;const t=document.getElementById("vscode-workbench-auth-session"),r=t?t.getAttribute("data-settings"):void 0;if(r)try{e=JSON.parse(r)}catch{}e&&(this.setPassword(`${U.default.urlProtocol}.login`,"account",JSON.stringify(e)),this.b=`${U.default.urlProtocol}-${e.providerId}.login`,this.setPassword(this.b,"account",JSON.stringify(e.scopes.map(o=>({id:e.id,scopes:o,accessToken:e.accessToken})))))}get d(){if(!this.c){try{const e=window.localStorage.getItem(f.a);e&&(this.c=JSON.parse(e))}catch{}Array.isArray(this.c)||(this.c=[])}return this.c}e(){window.localStorage.setItem(f.a,JSON.stringify(this.d))}async getPassword(e,t){return this.f(e,t)}async f(e,t){for(const r of this.d)if(r.service===e&&(typeof t!="string"||t===r.account))return r.password;return null}async setPassword(e,t,r){this.g(e,t),this.d.push({service:e,account:t,password:r}),this.e();try{if(r&&e===this.b){const o=JSON.parse(r);Array.isArray(o)&&o.length===0&&await this.h(e)}}catch(o){console.log(o)}}async deletePassword(e,t){const r=await this.g(e,t);if(r&&e===this.b)try{await this.h(e)}catch(o){console.log(o)}return r}async g(e,t){let r=!1;return this.c=this.d.filter(o=>o.service===e&&o.account===t?(r=!0,!1):!0),r&&this.e(),r}async findPassword(e){return this.f(e)}async findCredentials(e){return this.d.filter(t=>t.service===e).map(({account:t,password:r})=>({account:t,password:r}))}async h(e){const t=new Map;t.set("logout",String(!0)),t.set("service",e),await(0,O.request)({url:q("/auth/logout",t).toString(!0)},w.CancellationToken.None)}async clear(){window.localStorage.removeItem(f.a)}}f.a="credentials.provider";class m extends R.Disposable{constructor(e){super(),this.j=e,this.c=this.B(new b.Emitter),this.onCallback=this.c.event,this.f=new Set,this.g=Date.now(),this.h=void 0}create(e={}){const t=++m.a,r=[`vscode-reqid=${t}`];for(const o of m.b){const i=e[o];i&&r.push(`vscode-${o}=${encodeURIComponent(i)}`)}if(!(e.authority==="vscode.github-authentication"&&e.path==="/dummy")){const o=`vscode-web.url-callbacks[${t}]`;window.localStorage.removeItem(o),this.f.add(t),this.k()}return a.URI.parse(window.location.href).with({path:this.j,query:r.join("&")})}k(){if(this.i)return;const e=()=>this.m();window.addEventListener("storage",e),this.i={dispose:()=>window.removeEventListener("storage",e)}}l(){this.i?.dispose(),this.i=void 0}async m(){const e=Date.now()-this.g;e>1e3?this.n():this.h===void 0&&(this.h=setTimeout(()=>{this.h=void 0,this.n()},1e3-e))}n(){let e;for(const t of this.f){const r=`vscode-web.url-callbacks[${t}]`,o=window.localStorage.getItem(r);if(o!==null){try{this.c.fire(a.URI.revive(JSON.parse(o)))}catch(i){console.error(i)}e=e??new Set(this.f),e.delete(t),window.localStorage.removeItem(r)}}e&&(this.f=e,this.f.size===0&&this.l()),this.g=Date.now()}}m.a=0,m.b=["scheme","authority","path","query","fragment"];class s{static create(e){let t=!1,r,o=Object.create(null);return new URL(document.location.href).searchParams.forEach((n,x)=>{switch(x){case s.b:e.remoteAuthority&&n.startsWith(u.posix.sep)?r={folderUri:a.URI.from({scheme:h.Schemas.vscodeRemote,path:n,authority:e.remoteAuthority})}:r={folderUri:a.URI.parse(n)},t=!0;break;case s.c:e.remoteAuthority&&n.startsWith(u.posix.sep)?r={workspaceUri:a.URI.from({scheme:h.Schemas.vscodeRemote,path:n,authority:e.remoteAuthority})}:r={workspaceUri:a.URI.parse(n)},t=!0;break;case s.a:r=void 0,t=!0;break;case s.d:try{o=(0,I.parse)(n)}catch(A){console.error(A)}break}}),t||(e.folderUri?r={folderUri:a.URI.revive(e.folderUri)}:e.workspaceUri&&(r={workspaceUri:a.URI.revive(e.workspaceUri)})),new s(r,o,e)}constructor(e,t,r){this.workspace=e,this.payload=t,this.e=r,this.trusted=!0}async open(e,t){if(t?.reuse&&!t.payload&&this.g(this.workspace,e))return!0;const r=this.f(e,t);if(r){if(t?.reuse)return window.location.href=r,!0;{let o;return(0,d.isStandalone)()?o=window.open(r,"_blank","toolbar=no"):o=window.open(r),!!o}}return!1}f(e,t){let r;if(!e)r=`${document.location.origin}${document.location.pathname}?${s.a}=true`;else if((0,c.isFolderToOpen)(e)){let o;this.e.remoteAuthority&&e.folderUri.scheme===h.Schemas.vscodeRemote?o=`${u.posix.sep}${(0,S.ltrim)(e.folderUri.path,u.posix.sep)}`:o=encodeURIComponent(e.folderUri.toString(!0)),r=`${document.location.origin}${document.location.pathname}?${s.b}=${o}`}else if((0,c.isWorkspaceToOpen)(e)){let o;this.e.remoteAuthority&&e.workspaceUri.scheme===h.Schemas.vscodeRemote?o=`${u.posix.sep}${(0,S.ltrim)(e.workspaceUri.path,u.posix.sep)}`:o=encodeURIComponent(e.workspaceUri.toString(!0)),r=`${document.location.origin}${document.location.pathname}?${s.c}=${o}`}return t?.payload&&(r+=`&${s.d}=${encodeURIComponent(JSON.stringify(t.payload))}`),r}g(e,t){return!e||!t?e===t:(0,c.isFolderToOpen)(e)&&(0,c.isFolderToOpen)(t)?(0,v.isEqual)(e.folderUri,t.folderUri):(0,c.isWorkspaceToOpen)(e)&&(0,c.isWorkspaceToOpen)(t)?(0,v.isEqual)(e.workspaceUri,t.workspaceUri):!1}hasRemote(){if(this.workspace){if((0,c.isFolderToOpen)(this.workspace))return this.workspace.folderUri.scheme===h.Schemas.vscodeRemote;if((0,c.isWorkspaceToOpen)(this.workspace))return this.workspace.workspaceUri.scheme===h.Schemas.vscodeRemote}return!0}}s.a="ew",s.b="folder",s.c="workspace",s.d="payload";function q(l,e){let t;if(e){let r=0;e.forEach((o,i)=>{t||(t=""),t+=`${r++===0?"":"&"}${i}=${encodeURIComponent(o)}`})}return l=(window.location.pathname+"/"+l).replace(/\/\/+/g,"/"),a.URI.parse(window.location.href).with({path:l,query:t})}(function(){const l=document.getElementById("vscode-workbench-web-configuration"),e=l?l.getAttribute("data-settings"):void 0;if(!l||!e)throw new Error("Missing web configuration element");const t={...JSON.parse(e),remoteAuthority:location.host};(0,k.create)(document.body,{...t,settingsSyncOptions:t.settingsSyncOptions?{enabled:t.settingsSyncOptions.enabled}:void 0,workspaceProvider:s.create(t),urlCallbackProvider:new m(t.callbackRoute),credentialsProvider:t.remoteAuthority?void 0:new f,resolveExternalUri:r=>{let o=r;const i=(0,E.extractLocalHostUriMetaDataForPortMapping)(o);if(i&&o.authority!==location.host)if(t.productConfiguration&&t.productConfiguration.proxyEndpointTemplate)o=a.URI.parse(new URL(t.productConfiguration.proxyEndpointTemplate.replace("{{port}}",i.port.toString()),window.location.href).toString());else throw new Error(`Failed to resolve external URI: ${r.toString()}. Could not determine base url because productConfiguration missing.`);return Promise.resolve(o)},tunnelProvider:{tunnelFactory:(r,o)=>{const i=new b.Emitter;let n=!1;return Promise.resolve({remoteAddress:r.remoteAddress,localAddress:`localhost:${r.remoteAddress.port}`,onDidDispose:i.event,dispose:()=>{n||(n=!0,i.fire())}})}}})})()})}).call(this);

//# sourceMappingURL=workbench.js.map

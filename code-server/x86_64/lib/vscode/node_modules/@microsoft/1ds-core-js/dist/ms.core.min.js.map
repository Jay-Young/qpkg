{"version":3,"file":"ms.core.min.js","sources":["../dist-esm/src/Enums.js","../dist-esm/src/Utils.js","../dist-esm/src/AppInsightsCore.js","../dist-esm/src/BaseCore.js","../dist-esm/src/ESPromise.js","../dist-esm/src/ESPromiseScheduler.js","../dist-esm/src/ValueSanitizer.js"],"sourcesContent":["/*\n * 1DS JS SDK Core, 3.2.3\n * Copyright (c) Microsoft and contributors. All rights reserved.\n * (Microsoft Internal Only)\n */\n/**\r\n * Enums.ts\r\n * @author Abhilash Panwar (abpanwar)\r\n * @copyright Microsoft 2018\r\n * File containing the enums as constants.\r\n */\r\nimport { __assignFn as __assign } from \"@microsoft/applicationinsights-shims\";\r\nimport { _InternalMessageId, createEnumStyle, objFreeze } from \"@microsoft/applicationinsights-core-js\";\r\n/**\r\n * The ValueKind contains a set of values that specify value kind of the property.\r\n * Either PII (Personal Identifiable Information) or customer content.\r\n */\r\nexport var ValueKind = createEnumStyle({\r\n    NotSet: 0 /* eValueKind.NotSet */,\r\n    Pii_DistinguishedName: 1 /* eValueKind.Pii_DistinguishedName */,\r\n    Pii_GenericData: 2 /* eValueKind.Pii_GenericData */,\r\n    Pii_IPV4Address: 3 /* eValueKind.Pii_IPV4Address */,\r\n    Pii_IPv6Address: 4 /* eValueKind.Pii_IPv6Address */,\r\n    Pii_MailSubject: 5 /* eValueKind.Pii_MailSubject */,\r\n    Pii_PhoneNumber: 6 /* eValueKind.Pii_PhoneNumber */,\r\n    Pii_QueryString: 7 /* eValueKind.Pii_QueryString */,\r\n    Pii_SipAddress: 8 /* eValueKind.Pii_SipAddress */,\r\n    Pii_SmtpAddress: 9 /* eValueKind.Pii_SmtpAddress */,\r\n    Pii_Identity: 10 /* eValueKind.Pii_Identity */,\r\n    Pii_Uri: 11 /* eValueKind.Pii_Uri */,\r\n    Pii_Fqdn: 12 /* eValueKind.Pii_Fqdn */,\r\n    Pii_IPV4AddressLegacy: 13 /* eValueKind.Pii_IPV4AddressLegacy */,\r\n    CustomerContent_GenericContent: 32 /* eValueKind.CustomerContent_GenericContent */\r\n});\r\n/**\r\n * The EventLatency contains a set of values that specify the latency with which an event is sent.\r\n */\r\nexport var EventLatency = createEnumStyle({\r\n    /**\r\n     * Normal latency.\r\n     */\r\n    Normal: 1 /* EventLatencyValue.Normal */,\r\n    /**\r\n     * Cost deferred latency. At the moment this latency is treated as Normal latency.\r\n     */\r\n    CostDeferred: 2 /* EventLatencyValue.CostDeferred */,\r\n    /**\r\n     * Real time latency.\r\n     */\r\n    RealTime: 3 /* EventLatencyValue.RealTime */,\r\n    /**\r\n     * Bypass normal batching/timing and send as soon as possible, this will still send asynchronously.\r\n     * Added in v3.1.1\r\n     */\r\n    Immediate: 4 /* EventLatencyValue.Immediate */\r\n});\r\n/**\r\n * Enum for property types.\r\n */\r\nexport var EventPropertyType = createEnumStyle({\r\n    Unspecified: 0 /* eEventPropertyType.Unspecified */,\r\n    String: 1 /* eEventPropertyType.String */,\r\n    Int32: 2 /* eEventPropertyType.Int32 */,\r\n    UInt32: 3 /* eEventPropertyType.UInt32 */,\r\n    Int64: 4 /* eEventPropertyType.Int64 */,\r\n    UInt64: 5 /* eEventPropertyType.UInt64 */,\r\n    Double: 6 /* eEventPropertyType.Double */,\r\n    Bool: 7 /* eEventPropertyType.Bool */,\r\n    Guid: 8 /* eEventPropertyType.Guid */,\r\n    DateTime: 9 /* eEventPropertyType.DateTime */\r\n});\r\n/**\r\n * The EventPersistence contains a set of values that specify the event's persistence.\r\n */\r\nexport var EventPersistence = createEnumStyle({\r\n    /**\r\n     * Normal persistence.\r\n     */\r\n    Normal: 1 /* EventPersistenceValue.Normal */,\r\n    /**\r\n     * Critical persistence.\r\n     */\r\n    Critical: 2 /* EventPersistenceValue.Critical */\r\n});\r\nexport var TraceLevel = createEnumStyle({\r\n    NONE: 0 /* eTraceLevel.NONE */,\r\n    ERROR: 1 /* eTraceLevel.ERROR */,\r\n    WARNING: 2 /* eTraceLevel.WARNING */,\r\n    INFORMATION: 3 /* eTraceLevel.INFORMATION */\r\n});\r\nexport var _ExtendedInternalMessageId = objFreeze(__assign(__assign({}, _InternalMessageId), createEnumStyle({\r\n    AuthHandShakeError: 501 /* _eExtendedInternalMessageId.AuthHandShakeError */,\r\n    AuthRedirectFail: 502 /* _eExtendedInternalMessageId.AuthRedirectFail */,\r\n    BrowserCannotReadLocalStorage: 503 /* _eExtendedInternalMessageId.BrowserCannotReadLocalStorage */,\r\n    BrowserCannotWriteLocalStorage: 504 /* _eExtendedInternalMessageId.BrowserCannotWriteLocalStorage */,\r\n    BrowserDoesNotSupportLocalStorage: 505 /* _eExtendedInternalMessageId.BrowserDoesNotSupportLocalStorage */,\r\n    CannotParseBiBlobValue: 506 /* _eExtendedInternalMessageId.CannotParseBiBlobValue */,\r\n    CannotParseDataAttribute: 507 /* _eExtendedInternalMessageId.CannotParseDataAttribute */,\r\n    CVPluginNotAvailable: 508 /* _eExtendedInternalMessageId.CVPluginNotAvailable */,\r\n    DroppedEvent: 509 /* _eExtendedInternalMessageId.DroppedEvent */,\r\n    ErrorParsingAISessionCookie: 510 /* _eExtendedInternalMessageId.ErrorParsingAISessionCookie */,\r\n    ErrorProvidedChannels: 511 /* _eExtendedInternalMessageId.ErrorProvidedChannels */,\r\n    FailedToGetCookies: 512 /* _eExtendedInternalMessageId.FailedToGetCookies */,\r\n    FailedToInitializeCorrelationVector: 513 /* _eExtendedInternalMessageId.FailedToInitializeCorrelationVector */,\r\n    FailedToInitializeSDK: 514 /* _eExtendedInternalMessageId.FailedToInitializeSDK */,\r\n    InvalidContentBlob: 515 /* _eExtendedInternalMessageId.InvalidContentBlob */,\r\n    InvalidCorrelationValue: 516 /* _eExtendedInternalMessageId.InvalidCorrelationValue */,\r\n    SessionRenewalDateIsZero: 517 /* _eExtendedInternalMessageId.SessionRenewalDateIsZero */,\r\n    SendPostOnCompleteFailure: 518 /* _eExtendedInternalMessageId.SendPostOnCompleteFailure */,\r\n    PostResponseHandler: 519 /* _eExtendedInternalMessageId.PostResponseHandler */,\r\n    SDKNotInitialized: 520 /* _eExtendedInternalMessageId.SDKNotInitialized */\r\n})));\r\n//# sourceMappingURL=Enums.js.map","/*\n * 1DS JS SDK Core, 3.2.3\n * Copyright (c) Microsoft and contributors. All rights reserved.\n * (Microsoft Internal Only)\n */\nvar _a;\r\n/**\r\n * Utils.ts\r\n * @author  Abhilash Panwar (abpanwar) Hector Hernandez (hectorh)\r\n * @copyright Microsoft 2018\r\n * File containing utility functions.\r\n */\r\nimport { objCreateFn, strShimObject } from \"@microsoft/applicationinsights-shims\";\r\nimport { getDocument, getNavigator, getWindow, getGlobalInst, objForEachKey, isUndefined, isNullOrUndefined, isNumber, isReactNative, isString, isBoolean, isArray, newGuid, isObject, perfNow, hasOwnProperty, addEventHandler, uaDisallowsSameSiteNone, strPrototype, objDefineAccessors, toISOString, strTrim, isFunction, objKeys, arrReduce, arrMap, arrIndexOf, arrForEach, strUndefined, strObject, areCookiesSupported, safeGetCookieMgr, generateW3CId, mwcRandom32, mwcRandomSeed, random32, randomValue, newId, isIE, dateNow, isError, isDate, isTypeof, strEndsWith, useXDomainRequest, isBeaconsSupported, addPageUnloadEventListener, } from \"@microsoft/applicationinsights-core-js\";\r\nexport var Version = '3.2.3';\r\nexport var FullVersionString = \"1DS-Web-JS-\" + Version;\r\n// Defining here so we don't need to take (import) the ApplicationInsights Common module\r\nvar strDisabledPropertyName = \"Microsoft_ApplicationInsights_BypassAjaxInstrumentation\";\r\nvar strWithCredentials = \"withCredentials\";\r\nvar strTimeout = \"timeout\";\r\n// If value is array just get the type for the first element\r\nvar _fieldTypeEventPropMap = (_a = {},\r\n    _a[0 /* FieldValueSanitizerType.NotSet */] = 0 /* eEventPropertyType.Unspecified */,\r\n    _a[2 /* FieldValueSanitizerType.Number */] = 6 /* eEventPropertyType.Double */,\r\n    _a[1 /* FieldValueSanitizerType.String */] = 1 /* eEventPropertyType.String */,\r\n    _a[3 /* FieldValueSanitizerType.Boolean */] = 7 /* eEventPropertyType.Bool */,\r\n    _a[4096 /* FieldValueSanitizerType.Array */ | 2 /* FieldValueSanitizerType.Number */] = 6 /* eEventPropertyType.Double */,\r\n    _a[4096 /* FieldValueSanitizerType.Array */ | 1 /* FieldValueSanitizerType.String */] = 1 /* eEventPropertyType.String */,\r\n    _a[4096 /* FieldValueSanitizerType.Array */ | 3 /* FieldValueSanitizerType.Boolean */] = 7 /* eEventPropertyType.Bool */,\r\n    _a);\r\n/**\r\n * @ignore\r\n */\r\n// let _uaDisallowsSameSiteNone = null;\r\nvar uInt8ArraySupported = null;\r\n// var _areCookiesAvailable: boolean | undefined;\r\n/**\r\n * Checks if document object is available\r\n */\r\nexport var isDocumentObjectAvailable = Boolean(getDocument());\r\n/**\r\n * Checks if window object is available\r\n */\r\nexport var isWindowObjectAvailable = Boolean(getWindow());\r\n/**\r\n * Checks if value is assigned to the given param.\r\n * @param value - The token from which the tenant id is to be extracted.\r\n * @returns True/false denoting if value is assigned to the param.\r\n */\r\nexport function isValueAssigned(value) {\r\n    /// <summary> takes a value and checks for undefined, null and empty string </summary>\r\n    /// <param type=\"any\"> value to be tested </param>\r\n    /// <returns> true if value is null undefined or emptyString </returns>\r\n    return !(value === \"\" || isNullOrUndefined(value));\r\n}\r\n/**\r\n * Gets the tenant id from the tenant token.\r\n * @param apiKey - The token from which the tenant id is to be extracted.\r\n * @returns The tenant id.\r\n */\r\nexport function getTenantId(apiKey) {\r\n    if (apiKey) {\r\n        var indexTenantId = apiKey.indexOf(\"-\");\r\n        if (indexTenantId > -1) {\r\n            return apiKey.substring(0, indexTenantId);\r\n        }\r\n    }\r\n    return \"\";\r\n}\r\n/**\r\n * Checks if Uint8Array are available in the current environment. Safari and Firefox along with\r\n * ReactNative are known to not support Uint8Array properly.\r\n * @returns True if available, false otherwise.\r\n */\r\nexport function isUint8ArrayAvailable() {\r\n    if (uInt8ArraySupported === null) {\r\n        uInt8ArraySupported = !isUndefined(Uint8Array) && !isSafariOrFirefox() && !isReactNative();\r\n    }\r\n    return uInt8ArraySupported;\r\n}\r\n/**\r\n * Checks if the value is a valid EventLatency.\r\n * @param value - The value that needs to be checked.\r\n * @returns True if the value is in AWTEventLatency, false otherwise.\r\n */\r\nexport function isLatency(value) {\r\n    if (value && isNumber(value) && value >= 1 /* EventLatencyValue.Normal */ && value <= 4 /* EventLatencyValue.Immediate */) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\n/**\r\n * Sanitizes the Property. It checks the that the property name and value are valid. It also\r\n * checks/populates the correct type and pii of the property value.\r\n * @param name - property name                          - The property name.\r\n * @param property - The property value or an IEventProperty containing value,\r\n * type ,pii and customer content.\r\n * @returns IEventProperty containing valid name, value, pii and type or null if invalid.\r\n */\r\nexport function sanitizeProperty(name, property, stringifyObjects) {\r\n    // Check that property is valid\r\n    if ((!property && !isValueAssigned(property)) || typeof name !== \"string\") {\r\n        return null;\r\n    }\r\n    // Perf optimization -- only need to get the type once not multiple times\r\n    var propType = typeof property;\r\n    // If the property isn't IEventProperty (and is either string, number, boolean or array), convert it into one.\r\n    if (propType === \"string\" || propType === \"number\" || propType === \"boolean\" || isArray(property)) {\r\n        property = { value: property };\r\n    }\r\n    else if (propType === \"object\" && !property.hasOwnProperty(\"value\")) {\r\n        property = { value: stringifyObjects ? JSON.stringify(property) : property };\r\n    }\r\n    else if (isNullOrUndefined(property.value)\r\n        || property.value === \"\" || (!isString(property.value)\r\n        && !isNumber(property.value) && !isBoolean(property.value)\r\n        && !isArray(property.value))) {\r\n        // Since property is IEventProperty, we need to validate its value\r\n        return null;\r\n    }\r\n    // We need to check that if the property value is an array, it is valid\r\n    if (isArray(property.value) &&\r\n        !isArrayValid(property.value)) {\r\n        return null;\r\n    }\r\n    // If either pii or cc is set convert value to string (since only string pii/cc is allowed).\r\n    // If the value is a complex type like an array that can't be converted to string we will drop\r\n    // the property.\r\n    if (!isNullOrUndefined(property.kind)) {\r\n        if (isArray(property.value) || !isValueKind(property.kind)) {\r\n            return null;\r\n        }\r\n        property.value = property.value.toString();\r\n    }\r\n    return property;\r\n}\r\nexport function getCommonSchemaMetaData(value, kind, type) {\r\n    var encodedTypeValue = -1;\r\n    if (!isUndefined(value)) {\r\n        if (kind > 0) {\r\n            if (kind === 32) {\r\n                // encode customer content. Value can only be string. bit 13-16 are for cc\r\n                encodedTypeValue = (1 << 13);\r\n            }\r\n            else if (kind <= 13) {\r\n                // encode PII. Value can only be string. bits 5-12 are for Pii\r\n                encodedTypeValue = (kind << 5);\r\n            }\r\n        }\r\n        // isDataType checks that the \"type\" is a number so we don't need to check for undefined\r\n        if (isDataType(type)) {\r\n            // Data Type is provided and valid, so use that\r\n            if (encodedTypeValue === -1) {\r\n                // Don't return -1\r\n                encodedTypeValue = 0;\r\n            }\r\n            encodedTypeValue |= type;\r\n        }\r\n        else {\r\n            var propType = _fieldTypeEventPropMap[getFieldValueType(value)] || -1;\r\n            if (encodedTypeValue !== -1 && propType !== -1) {\r\n                // pii exists so we must return correct type\r\n                encodedTypeValue |= propType;\r\n            }\r\n            else if (propType === 6 /* eEventPropertyType.Double */) {\r\n                encodedTypeValue = propType;\r\n            }\r\n        }\r\n    }\r\n    return encodedTypeValue;\r\n}\r\n/**\r\n * @deprecated - Use the core.getCookieMgr().disable()\r\n * Force the SDK not to store and read any data from cookies.\r\n * Overriding the applicationinsights-core version for tree-shaking\r\n */\r\nexport function disableCookies() {\r\n    safeGetCookieMgr(null).setEnabled(false);\r\n}\r\n/**\r\n * @deprecated - Use the oneDs.getCookieMgr().set()\r\n * Sets the value of a cookie.\r\n * @param name - Cookie name.\r\n * @param value - Cookie value.\r\n * @param days - Expiration days.\r\n */\r\nexport function setCookie(name, value, days) {\r\n    if (areCookiesSupported(null)) {\r\n        safeGetCookieMgr(null).set(name, value, days * 86400, null, \"/\");\r\n    }\r\n}\r\n/**\r\n * @deprecated - Use the oneDs.getCookieMgr().del()\r\n * Deletes a cookie, by setting its expiration to -1.\r\n * @param name - Cookie name to delete.\r\n */\r\nexport function deleteCookie(name) {\r\n    if (areCookiesSupported(null)) {\r\n        safeGetCookieMgr(null).del(name);\r\n    }\r\n}\r\n/**\r\n * @deprecated - Use the oneDs.getCookieMgr().get()\r\n * Gets the cookie value for the specified cookie.\r\n * if value is k1=v1&k2==v2 then will return 'v1' for key 'k1'\r\n * @param cookieName - Cookie name.\r\n */\r\nexport function getCookie(name) {\r\n    if (areCookiesSupported(null)) {\r\n        return getCookieValue(safeGetCookieMgr(null), name);\r\n    }\r\n    return \"\";\r\n}\r\n/**\r\n * Helper to get and decode the cookie value using decodeURIComponent, this is for historical\r\n * backward compatibility where the document.cookie value was decoded before parsing.\r\n * @param cookieMgr - The cookie manager to use\r\n * @param name - The name of the cookie to get\r\n * @param decode - A flag to indicate whether the cookie value should be decoded\r\n * @returns The decoded cookie value (if available) otherwise an empty string.\r\n */\r\nexport function getCookieValue(cookieMgr, name, decode) {\r\n    if (decode === void 0) { decode = true; }\r\n    var cookieValue;\r\n    if (cookieMgr) {\r\n        cookieValue = cookieMgr.get(name);\r\n        if (decode && cookieValue && decodeURIComponent) {\r\n            cookieValue = decodeURIComponent(cookieValue);\r\n        }\r\n    }\r\n    return cookieValue || \"\";\r\n}\r\n/**\r\n * Create a new guid.\r\n * @param style - The style of guid to generated, defaults to Digits\r\n * Digits (Default) : 32 digits separated by hyphens: 00000000-0000-0000-0000-000000000000\r\n * Braces - 32 digits separated by hyphens, enclosed in braces: {00000000-0000-0000-0000-000000000000}\r\n * Parentheses - 32 digits separated by hyphens, enclosed in parentheses: (00000000-0000-0000-0000-000000000000)\r\n * Numeric - 32 digits: 00000000000000000000000000000000\r\n * @returns The formatted guid.\r\n */\r\nexport function createGuid(style) {\r\n    if (style === void 0) { style = \"D\" /* GuidStyle.Digits */; }\r\n    var theGuid = newGuid();\r\n    if (style === \"B\" /* GuidStyle.Braces */) {\r\n        theGuid = \"{\" + theGuid + \"}\";\r\n    }\r\n    else if (style === \"P\" /* GuidStyle.Parentheses */) {\r\n        theGuid = \"(\" + theGuid + \")\";\r\n    }\r\n    else if (style === \"N\" /* GuidStyle.Numeric */) {\r\n        theGuid = theGuid.replace(/-/g, \"\");\r\n    }\r\n    return theGuid;\r\n}\r\n/**\r\n * Pass in the objects to merge as arguments.\r\n * @param obj1 - object to merge.  Set this argument to 'true' for a deep extend.\r\n * @param obj2 - object to merge.\r\n * @param obj3 - object to merge.\r\n * @param obj4 - object to merge.\r\n * @param obj5 - object to merge.\r\n * @returns The extended object.\r\n */\r\nexport function extend(obj, obj2, obj3, obj4, obj5) {\r\n    // Variables\r\n    var extended = {};\r\n    var deep = false;\r\n    var i = 0;\r\n    var length = arguments.length;\r\n    var objProto = Object[strPrototype];\r\n    var theArgs = arguments;\r\n    // Check if a deep merge\r\n    if (objProto.toString.call(theArgs[0]) === \"[object Boolean]\") {\r\n        deep = theArgs[0];\r\n        i++;\r\n    }\r\n    // Loop through each object and conduct a merge\r\n    for (; i < length; i++) {\r\n        var obj = theArgs[i];\r\n        objForEachKey(obj, function (prop, value) {\r\n            // If deep merge and property is an object, merge properties\r\n            if (deep && value && isObject(value)) {\r\n                if (isArray(value)) {\r\n                    extended[prop] = extended[prop] || [];\r\n                    arrForEach(value, function (arrayValue, arrayIndex) {\r\n                        if (arrayValue && isObject(arrayValue)) {\r\n                            extended[prop][arrayIndex] = extend(true, extended[prop][arrayIndex], arrayValue);\r\n                        }\r\n                        else {\r\n                            extended[prop][arrayIndex] = arrayValue;\r\n                        }\r\n                    });\r\n                }\r\n                else {\r\n                    extended[prop] = extend(true, extended[prop], value);\r\n                }\r\n            }\r\n            else {\r\n                extended[prop] = value;\r\n            }\r\n        });\r\n    }\r\n    return extended;\r\n}\r\nexport var getTime = perfNow;\r\nexport function isValueKind(value) {\r\n    // Always assume that it's a number (no type checking) for performance as this is used during the JSON serialization\r\n    if (value === 0 /* eValueKind.NotSet */ || ((value > 0 /* eValueKind.NotSet */ && value <= 13 /* eValueKind.Pii_IPV4AddressLegacy */) || value === 32 /* eValueKind.CustomerContent_GenericContent */)) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\nfunction isDataType(value) {\r\n    // Remark: 0 returns false, but it doesn't affect encoding anyways\r\n    // Always assume that it's a number (no type checking) for performance as this is used during the JSON serialization\r\n    if (value >= 0 && value <= 9) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\nfunction isSafariOrFirefox() {\r\n    var nav = getNavigator();\r\n    // If non-browser navigator will be undefined\r\n    if (!isUndefined(nav) && nav.userAgent) {\r\n        var ua = nav.userAgent.toLowerCase();\r\n        if ((ua.indexOf(\"safari\") >= 0 || ua.indexOf(\"firefox\") >= 0) && ua.indexOf(\"chrome\") < 0) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nexport function isArrayValid(value) {\r\n    return value.length > 0;\r\n}\r\nexport function setProcessTelemetryTimings(event, identifier) {\r\n    var evt = event;\r\n    evt.timings = evt.timings || {};\r\n    evt.timings.processTelemetryStart = evt.timings.processTelemetryStart || {};\r\n    evt.timings.processTelemetryStart[identifier] = getTime();\r\n}\r\n/**\r\n * Returns a bitwise value for the FieldValueSanitizerType enum representing the decoded type of the passed value\r\n * @param value The value to determine the type\r\n */\r\nexport function getFieldValueType(value) {\r\n    var theType = 0 /* FieldValueSanitizerType.NotSet */;\r\n    if (value !== null && value !== undefined) {\r\n        var objType = typeof value;\r\n        if (objType === \"string\") {\r\n            theType = 1 /* FieldValueSanitizerType.String */;\r\n        }\r\n        else if (objType === \"number\") {\r\n            theType = 2 /* FieldValueSanitizerType.Number */;\r\n        }\r\n        else if (objType === \"boolean\") {\r\n            theType = 3 /* FieldValueSanitizerType.Boolean */;\r\n        }\r\n        else if (objType === strShimObject) {\r\n            theType = 4 /* FieldValueSanitizerType.Object */;\r\n            if (isArray(value)) {\r\n                theType = 4096 /* FieldValueSanitizerType.Array */;\r\n                if (value.length > 0) {\r\n                    // Empty arrays are not supported and are considered to be the same as null\r\n                    theType |= getFieldValueType(value[0]);\r\n                }\r\n            }\r\n            else if (hasOwnProperty(value, \"value\")) {\r\n                // Looks like an IEventProperty\r\n                theType = 8192 /* FieldValueSanitizerType.EventProperty */ | getFieldValueType(value.value);\r\n            }\r\n        }\r\n    }\r\n    return theType;\r\n}\r\nexport var Utils = {\r\n    Version: Version,\r\n    FullVersionString: FullVersionString,\r\n    strUndefined: strUndefined,\r\n    strObject: strObject,\r\n    Undefined: strUndefined,\r\n    arrForEach: arrForEach,\r\n    arrIndexOf: arrIndexOf,\r\n    arrMap: arrMap,\r\n    arrReduce: arrReduce,\r\n    objKeys: objKeys,\r\n    toISOString: toISOString,\r\n    isReactNative: isReactNative,\r\n    isString: isString,\r\n    isNumber: isNumber,\r\n    isBoolean: isBoolean,\r\n    isFunction: isFunction,\r\n    isArray: isArray,\r\n    isObject: isObject,\r\n    strTrim: strTrim,\r\n    isDocumentObjectAvailable: isDocumentObjectAvailable,\r\n    isWindowObjectAvailable: isWindowObjectAvailable,\r\n    isValueAssigned: isValueAssigned,\r\n    getTenantId: getTenantId,\r\n    isBeaconsSupported: isBeaconsSupported,\r\n    isUint8ArrayAvailable: isUint8ArrayAvailable,\r\n    isLatency: isLatency,\r\n    sanitizeProperty: sanitizeProperty,\r\n    getISOString: toISOString,\r\n    useXDomainRequest: useXDomainRequest,\r\n    getCommonSchemaMetaData: getCommonSchemaMetaData,\r\n    cookieAvailable: areCookiesSupported,\r\n    disallowsSameSiteNone: uaDisallowsSameSiteNone,\r\n    setCookie: setCookie,\r\n    deleteCookie: deleteCookie,\r\n    getCookie: getCookie,\r\n    createGuid: createGuid,\r\n    extend: extend,\r\n    getTime: getTime,\r\n    isValueKind: isValueKind,\r\n    isArrayValid: isArrayValid,\r\n    objDefineAccessors: objDefineAccessors,\r\n    addPageUnloadEventListener: addPageUnloadEventListener,\r\n    setProcessTelemetryTimings: setProcessTelemetryTimings,\r\n    addEventHandler: addEventHandler,\r\n    getFieldValueType: getFieldValueType,\r\n    strEndsWith: strEndsWith,\r\n    objForEachKey: objForEachKey\r\n};\r\n/**\r\n * Provides a collection of utility functions, included for backward compatibility with previous releases.\r\n * @deprecated Marking this instance as deprecated in favor of direct usage of the helper functions\r\n * as direct usage provides better tree-shaking and minification by avoiding the inclusion of the unused items\r\n * in your resulting code.\r\n * Overriding the applicationinsights-core version for tree-shaking\r\n */\r\nexport var CoreUtils = {\r\n    _canUseCookies: undefined,\r\n    isTypeof: isTypeof,\r\n    isUndefined: isUndefined,\r\n    isNullOrUndefined: isNullOrUndefined,\r\n    hasOwnProperty: hasOwnProperty,\r\n    isFunction: isFunction,\r\n    isObject: isObject,\r\n    isDate: isDate,\r\n    isArray: isArray,\r\n    isError: isError,\r\n    isString: isString,\r\n    isNumber: isNumber,\r\n    isBoolean: isBoolean,\r\n    toISOString: toISOString,\r\n    arrForEach: arrForEach,\r\n    arrIndexOf: arrIndexOf,\r\n    arrMap: arrMap,\r\n    arrReduce: arrReduce,\r\n    strTrim: strTrim,\r\n    objCreate: objCreateFn,\r\n    objKeys: objKeys,\r\n    objDefineAccessors: objDefineAccessors,\r\n    addEventHandler: addEventHandler,\r\n    dateNow: dateNow,\r\n    isIE: isIE,\r\n    disableCookies: disableCookies,\r\n    newGuid: newGuid,\r\n    perfNow: perfNow,\r\n    newId: newId,\r\n    randomValue: randomValue,\r\n    random32: random32,\r\n    mwcRandomSeed: mwcRandomSeed,\r\n    mwcRandom32: mwcRandom32,\r\n    generateW3CId: generateW3CId\r\n};\r\n/**\r\n * Helper to identify whether we are running in a chromium based browser environment\r\n */\r\nexport function isChromium() {\r\n    return !!getGlobalInst(\"chrome\");\r\n}\r\n/**\r\n * Create and open an XMLHttpRequest object\r\n * @param method - The request method\r\n * @param urlString - The url\r\n * @param withCredentials - Option flag indicating that credentials should be sent\r\n * @param disabled - Optional flag indicating that the XHR object should be marked as disabled and not tracked (default is false)\r\n * @param isSync - Optional flag indicating if the instance should be a synchronous request (defaults to false)\r\n * @param timeout - Optional value identifying the timeout value that should be assigned to the XHR request\r\n * @returns A new opened XHR request\r\n */\r\nexport function openXhr(method, urlString, withCredentials, disabled, isSync, timeout) {\r\n    if (disabled === void 0) { disabled = false; }\r\n    if (isSync === void 0) { isSync = false; }\r\n    function _wrapSetXhrProp(xhr, prop, value) {\r\n        try {\r\n            xhr[prop] = value;\r\n        }\r\n        catch (e) {\r\n            // - Wrapping as depending on the environment setting the property may fail (non-terminally)\r\n        }\r\n    }\r\n    var xhr = new XMLHttpRequest();\r\n    if (disabled) {\r\n        // Tag the instance so it's not tracked (trackDependency)\r\n        // If the environment has locked down the XMLHttpRequest (preventExtensions and/or freeze), this would\r\n        // cause the request to fail and we no telemetry would be sent\r\n        _wrapSetXhrProp(xhr, strDisabledPropertyName, disabled);\r\n    }\r\n    if (withCredentials) {\r\n        // Some libraries require that the withCredentials flag is set \"before\" open and\r\n        // - Wrapping as IE 10 has started throwing when setting before open\r\n        _wrapSetXhrProp(xhr, strWithCredentials, withCredentials);\r\n    }\r\n    xhr.open(method, urlString, !isSync);\r\n    if (withCredentials) {\r\n        // withCredentials should be set AFTER open (https://xhr.spec.whatwg.org/#the-withcredentials-attribute)\r\n        // And older firefox instances from 11+ will throw for sync events (current versions don't) which happens during unload processing\r\n        _wrapSetXhrProp(xhr, strWithCredentials, withCredentials);\r\n    }\r\n    // Only set the timeout for asynchronous requests as\r\n    // \"Timeout shouldn't be used for synchronous XMLHttpRequests requests used in a document environment or it will throw an InvalidAccessError exception.\"\"\r\n    // https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/timeout\r\n    if (!isSync && timeout) {\r\n        _wrapSetXhrProp(xhr, strTimeout, timeout);\r\n    }\r\n    return xhr;\r\n}\r\n//# sourceMappingURL=Utils.js.map","/*\n * 1DS JS SDK Core, 3.2.3\n * Copyright (c) Microsoft and contributors. All rights reserved.\n * (Microsoft Internal Only)\n */\nimport { __extendsFn as __extends } from \"@microsoft/applicationinsights-shims\";\r\n/**\r\n * AppInsightsCore.ts\r\n * @author Abhilash Panwar (abpanwar) Hector Hernandez (hectorh)\r\n * @copyright Microsoft 2018\r\n */\r\nimport { AppInsightsCore as InternalCore, doPerf, arrForEach, dumpObj, DiagnosticLogger } from \"@microsoft/applicationinsights-core-js\";\r\nimport { isLatency, FullVersionString, getTime } from \"./Utils\";\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nvar PropVersion = \"version\";\r\nvar properties = \"properties\";\r\nvar AppInsightsCore = /** @class */ (function (_super) {\r\n    __extends(AppInsightsCore, _super);\r\n    function AppInsightsCore() {\r\n        var _this = _super.call(this) || this;\r\n        _this.pluginVersionStringArr = [];\r\n        _this.pluginVersionString = \"\";\r\n        dynamicProto(AppInsightsCore, _this, function (_self, _base) {\r\n            if (!_self.logger || !_self.logger.queue) {\r\n                // The AI Base can inject a No-Op logger so if not defined or the No-Op, change to use a default logger so initialization errors\r\n                // are not dropped on the floor if one is not already defined\r\n                _self.logger = new DiagnosticLogger({ loggingLevelConsole: 1 /* eLoggingSeverity.CRITICAL */ });\r\n            }\r\n            _self.initialize = function (config, extensions, logger, notificationManager) {\r\n                doPerf(_self, function () { return \"AppInsightsCore.initialize\"; }, function () {\r\n                    // Add default collector url\r\n                    if (config) {\r\n                        if (!config.endpointUrl) {\r\n                            config.endpointUrl = \"https://browser.events.data.microsoft.com/OneCollector/1.0/\";\r\n                        }\r\n                        var propertyStorageOverride = config.propertyStorageOverride;\r\n                        // Validate property storage override\r\n                        if (propertyStorageOverride && (!propertyStorageOverride.getProperty || !propertyStorageOverride.setProperty)) {\r\n                            throw new Error(\"Invalid property storage override passed.\");\r\n                        }\r\n                        if (config.channels) {\r\n                            arrForEach(config.channels, function (channels) {\r\n                                if (channels) {\r\n                                    arrForEach(channels, function (channel) {\r\n                                        if (channel.identifier && channel.version) {\r\n                                            var ver = channel.identifier + \"=\" + channel.version;\r\n                                            _self.pluginVersionStringArr.push(ver);\r\n                                        }\r\n                                    });\r\n                                }\r\n                            });\r\n                        }\r\n                    }\r\n                    _self.getWParam = function () {\r\n                        return typeof document !== \"undefined\" ? 0 : -1;\r\n                    };\r\n                    if (extensions) {\r\n                        arrForEach(extensions, function (ext) {\r\n                            if (ext && ext.identifier && ext.version) {\r\n                                var ver = ext.identifier + \"=\" + ext.version;\r\n                                _self.pluginVersionStringArr.push(ver);\r\n                            }\r\n                        });\r\n                    }\r\n                    _self.pluginVersionString = _self.pluginVersionStringArr.join(\";\");\r\n                    try {\r\n                        _base.initialize(config, extensions, logger, notificationManager);\r\n                        _self.pollInternalLogs(\"InternalLog\");\r\n                    }\r\n                    catch (e) {\r\n                        var logger_1 = _self.logger;\r\n                        var message = dumpObj(e);\r\n                        if (message.indexOf(\"channels\") !== -1) {\r\n                            // Add some additional context to the underlying reported error\r\n                            message += \"\\n - Channels must be provided through config.channels only!\";\r\n                        }\r\n                        logger_1.throwInternal(1 /* eLoggingSeverity.CRITICAL */, 514 /* _eExtendedInternalMessageId.FailedToInitializeSDK */, \"SDK Initialization Failed - no telemetry will be sent: \" + message);\r\n                    }\r\n                }, function () { return ({ config: config, extensions: extensions, logger: logger, notificationManager: notificationManager }); });\r\n            };\r\n            _self.track = function (item) {\r\n                doPerf(_self, function () { return \"AppInsightsCore.track\"; }, function () {\r\n                    var telemetryItem = item;\r\n                    if (telemetryItem) {\r\n                        telemetryItem.timings = telemetryItem.timings || {};\r\n                        telemetryItem.timings.trackStart = getTime();\r\n                        if (!isLatency(telemetryItem.latency)) {\r\n                            telemetryItem.latency = 1 /* EventLatencyValue.Normal */;\r\n                        }\r\n                        var itemExt = telemetryItem.ext = telemetryItem.ext || {};\r\n                        itemExt.sdk = itemExt.sdk || {};\r\n                        itemExt.sdk.ver = FullVersionString;\r\n                        var baseData = telemetryItem.baseData = telemetryItem.baseData || {};\r\n                        if (!baseData[properties]) {\r\n                            baseData[properties] = {};\r\n                        }\r\n                        var itemProperties = baseData[properties];\r\n                        if (!itemProperties[PropVersion]) {\r\n                            itemProperties[PropVersion] = \"\";\r\n                        }\r\n                        if (_self.pluginVersionString !== \"\") {\r\n                            itemProperties[PropVersion] = _self.pluginVersionString;\r\n                        }\r\n                    }\r\n                    _base.track(telemetryItem);\r\n                }, function () { return ({ item: item }); }, !(item.sync));\r\n            };\r\n        });\r\n        return _this;\r\n    }\r\n// Removed Stub for AppInsightsCore.prototype.initialize.\r\n// Removed Stub for AppInsightsCore.prototype.track.\r\n    return AppInsightsCore;\r\n}(InternalCore));\r\nexport default AppInsightsCore;\r\n//# sourceMappingURL=AppInsightsCore.js.map","/*\n * 1DS JS SDK Core, 3.2.3\n * Copyright (c) Microsoft and contributors. All rights reserved.\n * (Microsoft Internal Only)\n */\nimport { __extendsFn as __extends } from \"@microsoft/applicationinsights-shims\";\r\n/**\r\n * BaseCore.ts\r\n * Base Core is a subset of 1DS Web SDK Core. The purpose of Base Core is to generate a smaller bundle size while providing essential features of Core. Features that are not included in Base Core are:\r\n * 1. Internal logging\r\n * 2. Sending notifications on telemetry sent/discarded\r\n * @author Abhilash Panwar (abpanwar) Hector Hernandez (hectorh)\r\n * @copyright Microsoft 2018\r\n */\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\nimport { BaseCore as InternalCore, dumpObj, _throwInternal } from \"@microsoft/applicationinsights-core-js\";\r\nimport { FullVersionString, isDocumentObjectAvailable } from \"./Utils\";\r\nvar BaseCore = /** @class */ (function (_super) {\r\n    __extends(BaseCore, _super);\r\n    function BaseCore() {\r\n        var _this = _super.call(this) || this;\r\n        dynamicProto(BaseCore, _this, function (_self, _base) {\r\n            _self.initialize = function (config, extensions, logger, notificationManager) {\r\n                if (config && !config.endpointUrl) {\r\n                    config.endpointUrl = \"https://browser.events.data.microsoft.com/OneCollector/1.0/\";\r\n                }\r\n                _self.getWParam = function () {\r\n                    return isDocumentObjectAvailable ? 0 : -1;\r\n                };\r\n                try {\r\n                    _base.initialize(config, extensions, logger, notificationManager);\r\n                }\r\n                catch (e) {\r\n                    _throwInternal(_self.logger, 1 /* eLoggingSeverity.CRITICAL */, 514 /* _eExtendedInternalMessageId.FailedToInitializeSDK */, \"Initialization Failed: \" + dumpObj(e) + \"\\n - Note: Channels must be provided through config.channels only\");\r\n                }\r\n            };\r\n            _self.track = function (item) {\r\n                var telemetryItem = item;\r\n                if (telemetryItem) {\r\n                    var ext = telemetryItem.ext = telemetryItem.ext || {};\r\n                    ext.sdk = ext.sdk || {};\r\n                    ext.sdk.ver = FullVersionString;\r\n                }\r\n                _base.track(telemetryItem);\r\n            };\r\n        });\r\n        return _this;\r\n    }\r\n// Removed Stub for BaseCore.prototype.initialize.\r\n// Removed Stub for BaseCore.prototype.track.\r\n    return BaseCore;\r\n}(InternalCore));\r\nexport default BaseCore;\r\n//# sourceMappingURL=BaseCore.js.map","/*\n * 1DS JS SDK Core, 3.2.3\n * Copyright (c) Microsoft and contributors. All rights reserved.\n * (Microsoft Internal Only)\n */\n/**\r\n * ESPromise.ts\r\n * @author  Nev Wylie (newylie))\r\n * @copyright Microsoft 2019\r\n * Simplified wrapper to provide ES6 style Promise callback handling for older browsers\r\n */\r\nimport { isFunction } from \"@microsoft/applicationinsights-core-js\";\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\n/**\r\n * @ignore -- Don't include in the generated documentation\r\n * Using a local variable to assist with minfication\r\n */\r\nvar _isFunction = isFunction;\r\n/**\r\n * @ignore -- Don't include in the generated documentation\r\n * This function will be used as onFulfilled handler for any Promise found in the iterable passed to Promise.all.\r\n * The goal here is to capture in a closure the index of the current item from the iterable. If we did not create\r\n * this closure, the captured index variable would be the same one that the for loop updates and thus would always\r\n * be pointing to the last index in the iterable by the time that the onFulfilled handler is called.\r\n * However, note that for the resolvedCallback callback we want the opposite. For this one we do want to capture\r\n * the same variable that the for loop updates so that we have the full count of pending promises by the time\r\n * the onFulfilled handlers start getting called.\r\n * @param values The resolving promise values\r\n * @param index The index of this callback function\r\n * @param resolvedCallback THe callback function used to check if the \"all\" promise is complete\r\n */\r\nfunction _createPromiseAllOnResolvedFunction(values, index, resolvedCallback) {\r\n    return function (value) {\r\n        values[index] = value;\r\n        resolvedCallback();\r\n    };\r\n}\r\n/**\r\n * Simplified wrapper to provide ES6 style Promise callback handling for older browsers\r\n */\r\nvar ESPromise = /** @class */ (function () {\r\n    /**\r\n     * The Promise object represents the eventual completion (or failure) of an asynchronous operation, and its resulting value.\r\n     * @param resolverFunc A function that is passed with the arguments resolve and reject. The executor function is executed\r\n     * immediately by the Promise implementation, passing resolve and reject functions (the executor is called before the Promise\r\n     * constructor even returns the created object). The resolve and reject functions, when called, resolve or reject the promise,\r\n     * respectively. The executor normally initiates some asynchronous work, and then, once that completes, either calls the resolve\r\n     * function to resolve the promise or else rejects it if an error occurred. If an error is thrown in the executor function, the\r\n     * promise is rejected. The return value of the executor is ignored.\r\n     */\r\n    function ESPromise(resolverFunc) {\r\n        var _state = 0 /* PromiseState.Pending */;\r\n        var _settledValue = null;\r\n        var _queue = [];\r\n        dynamicProto(ESPromise, this, function (_this) {\r\n            _this.then = function (onResolved, onRejected) {\r\n                return new ESPromise(function (resolve, reject) {\r\n                    // Queue the new promise returned to be resolved or rejected\r\n                    // when this promise settles.\r\n                    _enqueue(onResolved, onRejected, resolve, reject);\r\n                });\r\n            };\r\n            _this[\"catch\"] = function (onRejected) {\r\n                return _this.then(null, onRejected);\r\n            };\r\n        });\r\n        function _enqueue(onResolved, onRejected, resolve, reject) {\r\n            _queue.push(function () {\r\n                var value;\r\n                try {\r\n                    // First call the onFulfilled or onRejected handler, on the settled value\r\n                    // of this promise. If the corresponding handler does not exist, simply\r\n                    // pass through the settled value.\r\n                    if (_state === 1 /* PromiseState.Resolved */) {\r\n                        value = _isFunction(onResolved) ? onResolved(_settledValue) : _settledValue;\r\n                    }\r\n                    else {\r\n                        value = _isFunction(onRejected) ? onRejected(_settledValue) : _settledValue;\r\n                    }\r\n                    if (value instanceof ESPromise) {\r\n                        // The called handlers returned a new promise, so the chained promise\r\n                        // will follow the state of this promise.\r\n                        value.then(resolve, reject);\r\n                    }\r\n                    else if (_state === 2 /* PromiseState.Rejected */ && !_isFunction(onRejected)) {\r\n                        // If there wasn't an onRejected handler and this promise is rejected, then\r\n                        // the chained promise also rejects with the same reason.\r\n                        reject(value);\r\n                    }\r\n                    else {\r\n                        // If this promise is fulfilled, then the chained promise is also fulfilled\r\n                        // with either the settled value of this promise (if no onFulfilled handler\r\n                        // was available) or the return value of the handler. If this promise is\r\n                        // rejected and there was an onRejected handler, then the chained promise is\r\n                        // fulfilled with the return value of the handler.\r\n                        resolve(value);\r\n                    }\r\n                }\r\n                catch (error) {\r\n                    // The chained promise will reject if there is any exception thrown while\r\n                    // calling the onFulfilled or onRejected handlers.\r\n                    reject(error);\r\n                    return;\r\n                }\r\n            });\r\n            // If this promise is already settled, then immediately process the callback we\r\n            // just added to the queue.\r\n            if (_state !== 0 /* PromiseState.Pending */) {\r\n                _processQueue();\r\n            }\r\n        }\r\n        function _processQueue() {\r\n            if (_queue.length > 0) {\r\n                // The onFulfilled and onRejected handlers must be called asynchronously. Thus,\r\n                // we make a copy of the queue and work on it once the current call stack unwinds.\r\n                var pending_1 = _queue.slice();\r\n                _queue = [];\r\n                setTimeout(function () {\r\n                    for (var i = 0, len = pending_1.length; i < len; ++i) {\r\n                        try {\r\n                            pending_1[i]();\r\n                        }\r\n                        catch (e) {\r\n                            // Don't let 1 failing handler break all others\r\n                            // TODO (newylie): Add some form of error reporting (i.e. Call any registered JS error handler so the error is reported)\r\n                        }\r\n                    }\r\n                }, 0);\r\n            }\r\n        }\r\n        function _resolve(value) {\r\n            if (_state === 0 /* PromiseState.Pending */) {\r\n                _settledValue = value;\r\n                _state = 1 /* PromiseState.Resolved */;\r\n                _processQueue();\r\n            }\r\n        }\r\n        function _reject(reason) {\r\n            if (_state === 0 /* PromiseState.Pending */) {\r\n                _settledValue = reason;\r\n                _state = 2 /* PromiseState.Rejected */;\r\n                _processQueue();\r\n            }\r\n        }\r\n        (function _initialize() {\r\n            if (!_isFunction(resolverFunc)) {\r\n                throw new TypeError(\"ESPromise: resolvedFunc argument is not a Function\");\r\n            }\r\n            try {\r\n                resolverFunc(_resolve, _reject);\r\n            }\r\n            catch (error) {\r\n                // This promise will immediately reject if any exception is thrown\r\n                // from within the executor function.\r\n                _reject(error);\r\n            }\r\n        })();\r\n    }\r\n    /**\r\n     * The Promise.resolve() method returns a Promise object that is resolved with a given value. If the value is a promise, that promise is returned;\r\n     * if the value is a thenable (i.e. has a \"then\" method), the returned promise will \"follow\" that thenable, adopting its eventual state; otherwise\r\n     * the returned promise will be fulfilled with the value. This function flattens nested layers of promise-like objects (e.g. a promise that resolves\r\n     * to a promise that resolves to something) into a single layer.\r\n     * @param value Argument to be resolved by this Promise. Can also be a Promise or a thenable to resolve.\r\n     */\r\n    ESPromise.resolve = function (value) {\r\n        if (value instanceof ESPromise) {\r\n            // Value is a Promise so just return it\r\n            return value;\r\n        }\r\n        else if (value && _isFunction(value.then)) {\r\n            // Value looks like a promise or thenable (has a then function)\r\n            return new ESPromise(function (resolve, reject) {\r\n                try {\r\n                    value.then(resolve, reject);\r\n                }\r\n                catch (error) {\r\n                    reject(error);\r\n                }\r\n            });\r\n        }\r\n        return new ESPromise(function (resolve) {\r\n            resolve(value);\r\n        });\r\n    };\r\n    /**\r\n     * The Promise.reject() method returns a Promise object that is rejected with a given reason.\r\n     * @param reason The reason why this Promise rejected.\r\n     */\r\n    ESPromise.reject = function (reason) {\r\n        return new ESPromise(function (resolve, reject) {\r\n            reject(reason);\r\n        });\r\n    };\r\n    /**\r\n     * The Promise.all() method returns a single Promise that resolves when all of the promises passed as an iterable\r\n     * have resolved or when the iterable contains no promises. It rejects with the reason of the first promise that\r\n     * rejects. There is no implied ordering in the execution of the array of Promises given. On some computers, they\r\n     * may be executed in parallel, or in some sense concurrently, while on others they may be executed serially. For\r\n     * this reason, there must be no dependency in any Promise on the order of execution of the Promises.\r\n     * This method can be useful for aggregating the results of multiple promises.\r\n     * FulfillmentSection - The returned promise is fulfilled with an array containing all the values of the iterable\r\n     * passed as argument (also non-promise values).\r\n     * If an empty iterable is passed, then this method returns (synchronously) an already resolved promise.\r\n     * If all of the passed-in promises fulfill, or are not promises, the promise returned by Promise.all is fulfilled\r\n     * asynchronously.\r\n     * RejectionSection - If any of the passed-in promises reject, Promise.all asynchronously rejects with the value of\r\n     * the promise that rejected, whether or not the other promises have resolved.\r\n     * @param iterable\r\n     */\r\n    ESPromise.all = function (iterable) {\r\n        if (!iterable || !iterable.length) {\r\n            return;\r\n        }\r\n        return new ESPromise(function (resolve, reject) {\r\n            try {\r\n                var values_1 = [];\r\n                var pending_2 = 0;\r\n                for (var lp = 0; lp < iterable.length; lp++) {\r\n                    var item = iterable[lp];\r\n                    // Quick and direct check for a Promise (will also catch a thenable)\r\n                    if (item && _isFunction(item.then)) {\r\n                        pending_2++;\r\n                        item.then(_createPromiseAllOnResolvedFunction(values_1, lp, function () {\r\n                            if (--pending_2 === 0) {\r\n                                resolve(values_1);\r\n                            }\r\n                        }), reject);\r\n                    }\r\n                    else {\r\n                        values_1[lp] = item;\r\n                    }\r\n                }\r\n                if (pending_2 === 0) {\r\n                    // All promises were either resolved or where not a promise\r\n                    setTimeout(function () {\r\n                        resolve(values_1);\r\n                    }, 0);\r\n                }\r\n            }\r\n            catch (error) {\r\n                reject(error);\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * The race function returns a Promise that is settled the same way (and takes the same value) as the first promise\r\n     * that settles amongst the promises of the iterable passed as an argument.\r\n     * If the iterable passed is empty, the promise returned will be forever pending.\r\n     * If the iterable contains one or more non-promise value and/or an already settled promise, then Promise.race will\r\n     * resolve to the first of these values found in the iterable.\r\n     * @param iterable\r\n     */\r\n    ESPromise.race = function (iterable) {\r\n        return new ESPromise(function (resolve, reject) {\r\n            if (!iterable || !iterable.length) {\r\n                return;\r\n            }\r\n            try {\r\n                var _loop_1 = function (lp) {\r\n                    var item = iterable[lp];\r\n                    // Quick and direct check for a Promise (will also catch a thenable)\r\n                    if (item && _isFunction(item.then)) {\r\n                        item.then(resolve, reject);\r\n                    }\r\n                    else {\r\n                        setTimeout(function () {\r\n                            resolve(item);\r\n                        }, 0);\r\n                    }\r\n                };\r\n                for (var lp = 0; lp < iterable.length; lp++) {\r\n                    _loop_1(lp);\r\n                }\r\n            }\r\n            catch (error) {\r\n                reject(error);\r\n            }\r\n        });\r\n    };\r\n// Removed Stub for ESPromise.prototype.then.\r\n// Removed Stub for ESPromise.prototype[\"catch\"].\r\n    return ESPromise;\r\n}());\r\nexport default ESPromise;\r\n//# sourceMappingURL=ESPromise.js.map","/*\n * 1DS JS SDK Core, 3.2.3\n * Copyright (c) Microsoft and contributors. All rights reserved.\n * (Microsoft Internal Only)\n */\n/**\r\n * ESPromiseScheduler.ts\r\n * @author Nev Wylie (newylie)\r\n * @copyright Microsoft 2019\r\n */\r\nimport ESPromise from \"./ESPromise\";\r\nimport { getGlobal } from \"@microsoft/applicationinsights-core-js\";\r\nimport dynamicProto from \"@microsoft/dynamicproto-js\";\r\n/** This is a default timeout that will cause outstanding running promises to be removed/rejected to avoid filling up memory with blocked events */\r\nvar LazyRejectPeriod = 600000; // 10 Minutes\r\n// These are global variables that are shared across ALL instances of the scheduler\r\n/**\r\n * @ignore\r\n */\r\nvar _schedulerId = 0;\r\n/**\r\n * @ignore\r\n */\r\nvar _running = [];\r\n/**\r\n * @ignore\r\n */\r\nvar _waiting = [];\r\n/**\r\n * @ignore\r\n */\r\nvar _timedOut = [];\r\n/**\r\n * @ignore\r\n */\r\nfunction _getTime() {\r\n    return new Date().getTime();\r\n}\r\n/**\r\n * Provides a simple mechanism queueing mechanism for scheduling events based on the ESPromise callbacks, this is used to ensure\r\n * order of async operations that are required to be executed in a specific order.\r\n */\r\nvar ESPromiseScheduler = /** @class */ (function () {\r\n    function ESPromiseScheduler(name, diagLog) {\r\n        var _promiseId = 0;\r\n        var _scheduledName = (name || \"<unnamed>\") + \".\" + _schedulerId;\r\n        _schedulerId++;\r\n        dynamicProto(ESPromiseScheduler, this, function (_this) {\r\n            var _lastEvent = null;\r\n            var _eventCount = 0;\r\n            _this.scheduleEvent = function (startEventAction, eventName, timeout) {\r\n                var uniqueId = _scheduledName + \".\" + _eventCount;\r\n                _eventCount++;\r\n                if (eventName) {\r\n                    uniqueId += \"-(\" + eventName + \")\";\r\n                }\r\n                var uniqueEventId = uniqueId + \"{\" + _promiseId + \"}\";\r\n                _promiseId++;\r\n                // Create the next scheduled event details\r\n                var newScheduledEvent = {\r\n                    evt: null,\r\n                    tm: _getTime(),\r\n                    id: uniqueEventId,\r\n                    isRunning: false,\r\n                    isAborted: false\r\n                };\r\n                if (!_lastEvent) {\r\n                    // We don't have any currently running event, so just start the next event\r\n                    newScheduledEvent.evt = _startWaitingEvent(newScheduledEvent);\r\n                }\r\n                else {\r\n                    // Start a new promise which will wait until all current active events are complete before starting\r\n                    // the new event, it does not resolve this scheduled event until after the new event is resolve to\r\n                    // ensure that all scheduled events are completed in the correct order\r\n                    newScheduledEvent.evt = _waitForPreviousEvent(newScheduledEvent, _lastEvent);\r\n                }\r\n                // Set this new event as the last one, so that any future events will wait for this one\r\n                _lastEvent = newScheduledEvent;\r\n                _lastEvent.evt._schId = uniqueEventId;\r\n                return newScheduledEvent.evt;\r\n                function _abortAndRemoveOldEvents(eventQueue) {\r\n                    var now = _getTime();\r\n                    var expired = now - LazyRejectPeriod;\r\n                    var len = eventQueue.length;\r\n                    var lp = 0;\r\n                    while (lp < len) {\r\n                        var evt = eventQueue[lp];\r\n                        if (evt && evt.tm < expired) {\r\n                            var message = null;\r\n                            if (evt.abort) {\r\n                                message = \"Aborting [\" + evt.id + \"] due to Excessive runtime (\" + (now - evt.tm) + \" ms)\";\r\n                                evt.abort(message);\r\n                            }\r\n                            else {\r\n                                message = \"Removing [\" + evt.id + \"] due to Excessive runtime (\" + (now - evt.tm) + \" ms)\";\r\n                            }\r\n                            _warnLog(message);\r\n                            eventQueue.splice(lp, 1);\r\n                            len--;\r\n                        }\r\n                        else {\r\n                            lp++;\r\n                        }\r\n                    }\r\n                }\r\n                function _cleanup(eventId, completed) {\r\n                    var toQueue = false;\r\n                    var removed = _removeQueuedEvent(_running, eventId);\r\n                    if (!removed) {\r\n                        removed = _removeQueuedEvent(_timedOut, eventId);\r\n                        toQueue = true;\r\n                    }\r\n                    if (removed) {\r\n                        if (removed.to) {\r\n                            // If there was a timeout stop it\r\n                            clearTimeout(removed.to);\r\n                            removed.to = null;\r\n                        }\r\n                        // TODO (newylie): Convert this into reportable metrics\r\n                        var tm = _getTime() - removed.tm;\r\n                        if (completed) {\r\n                            if (!toQueue) {\r\n                                _debugLog(\"Promise [\" + eventId + \"] Complete -- \" + tm + \" ms\");\r\n                            }\r\n                            else {\r\n                                _warnLog(\"Timed out event [\" + eventId + \"] finally complete -- \" + tm + \" ms\");\r\n                            }\r\n                        }\r\n                        else {\r\n                            _timedOut.push(removed);\r\n                            _warnLog(\"Event [\" + eventId + \"] Timed out and removed -- \" + tm + \" ms\");\r\n                        }\r\n                    }\r\n                    else {\r\n                        _debugLog(\"Failed to remove [\" + eventId + \"] from running queue\");\r\n                    }\r\n                    // Also if the last scheduled event was this event then clear it as we are now finished\r\n                    if (_lastEvent && _lastEvent.id === eventId) {\r\n                        _lastEvent = null;\r\n                    }\r\n                    _abortAndRemoveOldEvents(_running);\r\n                    _abortAndRemoveOldEvents(_waiting);\r\n                    _abortAndRemoveOldEvents(_timedOut);\r\n                }\r\n                // Return a callback function that will be called when the waiting promise is resolved or rejected to ensure\r\n                // that any outer promise is also resolved or rejected\r\n                function _removeScheduledEvent(eventId, callback) {\r\n                    return function (value) {\r\n                        _cleanup(eventId, true);\r\n                        callback && callback(value);\r\n                        return value;\r\n                    };\r\n                }\r\n                function _waitForFinalResult(eventId, startResult, schEventResolve, schEventReject) {\r\n                    startResult.then(function (value) {\r\n                        if (value instanceof ESPromise) {\r\n                            // If the result is a promise then this appears to be a chained result, so wait for this promise to complete\r\n                            _debugLog(\"Event [\" + eventId + \"] returned a promise -- waiting\");\r\n                            _waitForFinalResult(eventId, value, schEventResolve, schEventReject);\r\n                            return value;\r\n                        }\r\n                        else {\r\n                            return _removeScheduledEvent(eventId, schEventResolve)(value);\r\n                        }\r\n                    }, _removeScheduledEvent(eventId, schEventReject));\r\n                }\r\n                // Add the passed event to the active event list with resolve and reject callbacks that will remove\r\n                // it from the active event list\r\n                function _createScheduledEvent(eventDetails, startEvent) {\r\n                    var eventId = eventDetails.id;\r\n                    return new ESPromise(function (schEventResolve, schEventReject) {\r\n                        _debugLog(\"Event [\" + eventId + \"] Starting -- waited for \" + (eventDetails.wTm || \"--\") + \" ms\");\r\n                        eventDetails.isRunning = true;\r\n                        eventDetails.abort = function (message) {\r\n                            eventDetails.abort = null;\r\n                            eventDetails.isAborted = true;\r\n                            _cleanup(eventId, false);\r\n                            schEventReject(new Error(message));\r\n                        };\r\n                        var startResult = startEvent(eventId);\r\n                        if (startResult instanceof ESPromise) {\r\n                            if (timeout) {\r\n                                // Note: Only starting a timer if a timeout was specified\r\n                                eventDetails.to = setTimeout(function () {\r\n                                    _cleanup(eventId, false);\r\n                                    // Cause the listeners to reject (Note: We can't actually reject the waiting event)\r\n                                    schEventReject(new Error(\"Timed out after [\" + timeout + \"] ms\"));\r\n                                }, timeout);\r\n                            }\r\n                            _waitForFinalResult(eventId, startResult, function (theResult) {\r\n                                _debugLog(\"Event [\" + eventId + \"] Resolving after \" + (_getTime() - eventDetails.tm) + \" ms\");\r\n                                schEventResolve(theResult);\r\n                            }, schEventReject);\r\n                        }\r\n                        else {\r\n                            // The startEvent didn't return a promise so just return a resolved promise\r\n                            _debugLog(\"Promise [\" + eventId + \"] Auto completed as the start action did not return a promise\");\r\n                            schEventResolve();\r\n                        }\r\n                    });\r\n                }\r\n                function _startWaitingEvent(eventDetails) {\r\n                    var now = _getTime();\r\n                    eventDetails.wTm = now - eventDetails.tm;\r\n                    eventDetails.tm = now;\r\n                    if (eventDetails.isAborted) {\r\n                        return ESPromise.reject(new Error(\"[\" + uniqueId + \"] was aborted\"));\r\n                    }\r\n                    _running.push(eventDetails);\r\n                    return _createScheduledEvent(eventDetails, startEventAction);\r\n                }\r\n                // Start a new promise which will wait until all current active events are complete before starting\r\n                // the new event, it does not resolve this scheduled event until after the new event is resolve to\r\n                // ensure that all scheduled events are completed in the correct order\r\n                function _waitForPreviousEvent(eventDetails, waitForEvent) {\r\n                    var waitEvent = new ESPromise(function (waitResolve, waitReject) {\r\n                        var runTime = _getTime() - waitForEvent.tm;\r\n                        var prevId = waitForEvent.id;\r\n                        _debugLog(\"[\" + uniqueId + \"] is waiting for [\" + prevId + \":\" + runTime + \" ms] to complete before starting -- [\" + _waiting.length + \"] waiting and [\" + _running.length + \"] running\");\r\n                        eventDetails.abort = function (message) {\r\n                            eventDetails.abort = null;\r\n                            _removeQueuedEvent(_waiting, uniqueId);\r\n                            eventDetails.isAborted = true;\r\n                            waitReject(new Error(message));\r\n                        };\r\n                        // Wait for the previous event to complete\r\n                        waitForEvent.evt.then(function (value) {\r\n                            _removeQueuedEvent(_waiting, uniqueId);\r\n                            // Wait for the last event to complete before starting the new one, this ensures the execution\r\n                            // order so that we don't try and remove events that havn't been committed yet\r\n                            _startWaitingEvent(eventDetails).then(waitResolve, waitReject);\r\n                        }, function (reason) {\r\n                            _removeQueuedEvent(_waiting, uniqueId);\r\n                            // Wait for the last event to complete before starting the new one, this ensures the execution\r\n                            // order so that we don't try and remove events that havn't been committed yet\r\n                            _startWaitingEvent(eventDetails).then(waitResolve, waitReject);\r\n                        });\r\n                    });\r\n                    _waiting.push(eventDetails);\r\n                    return waitEvent;\r\n                }\r\n            };\r\n            function _removeQueuedEvent(queue, eventId) {\r\n                for (var lp = 0; lp < queue.length; lp++) {\r\n                    if (queue[lp].id === eventId) {\r\n                        return queue.splice(lp, 1)[0];\r\n                    }\r\n                }\r\n                return null;\r\n            }\r\n        });\r\n        function _debugLog(message) {\r\n            // Only log if running within test harness\r\n            var global = getGlobal();\r\n            if (global && global[\"QUnit\"]) {\r\n                // tslint:disable-next-line:no-console\r\n                console && console.log(\"ESPromiseScheduler[\" + _scheduledName + \"] \" + message);\r\n            }\r\n        }\r\n        function _warnLog(message) {\r\n            diagLog && diagLog.warnToConsole(\"ESPromiseScheduler[\" + _scheduledName + \"] \" + message);\r\n        }\r\n    }\r\n    ESPromiseScheduler.incomplete = function () {\r\n        return _running;\r\n    };\r\n    ESPromiseScheduler.waitingToStart = function () {\r\n        return _waiting;\r\n    };\r\n// Removed Stub for ESPromiseScheduler.prototype.scheduleEvent.\r\n    return ESPromiseScheduler;\r\n}());\r\nexport default ESPromiseScheduler;\r\n//# sourceMappingURL=ESPromiseScheduler.js.map","/*\n * 1DS JS SDK Core, 3.2.3\n * Copyright (c) Microsoft and contributors. All rights reserved.\n * (Microsoft Internal Only)\n */\nimport { isNullOrUndefined, objForEachKey, isString } from \"@microsoft/applicationinsights-core-js\";\r\nimport { isValueKind, isValueAssigned, getFieldValueType } from \"./Utils\";\r\nvar ValueSanitizer = /** @class */ (function () {\r\n    function ValueSanitizer(fieldSanitizerProvider) {\r\n        var _self = this;\r\n        // To aid with performance this is a lookup map to check if the field value sanitizer supports this field\r\n        var _sanitizerMap = {};\r\n        var _sanitizers = [];\r\n        var _fieldSanitizers = [];\r\n        if (fieldSanitizerProvider) {\r\n            _fieldSanitizers.push(fieldSanitizerProvider);\r\n        }\r\n        function _getFieldSanitizer(path, name) {\r\n            var result;\r\n            var fieldLookup = _sanitizerMap[path];\r\n            if (fieldLookup) {\r\n                result = fieldLookup[name];\r\n            }\r\n            if (!result && result !== null) {\r\n                // Null is a valid result indicating that the value sanitizer does not support this field\r\n                if (isString(path) && isString(name)) {\r\n                    if (_fieldSanitizers.length > 0) {\r\n                        for (var lp = 0; lp < _fieldSanitizers.length; lp++) {\r\n                            if (_fieldSanitizers[lp].handleField(path, name)) {\r\n                                result = {\r\n                                    canHandle: true,\r\n                                    fieldHandler: _fieldSanitizers[lp]\r\n                                };\r\n                                break;\r\n                            }\r\n                        }\r\n                    }\r\n                    else if (_sanitizers.length === 0) {\r\n                        // Special use-case where there is no sanitizer to pass on to, so just resolving the field\r\n                        // and returning the resulting value (same as sanitizeProperty())\r\n                        result = {\r\n                            canHandle: true\r\n                        };\r\n                    }\r\n                }\r\n                // We still don't have a handler so lets lookup the providers\r\n                if (!result && result !== null) {\r\n                    // Setting the result to null -- which means we and any contained sanitizers can't handle this field\r\n                    result = null;\r\n                    for (var lp = 0; lp < _sanitizers.length; lp++) {\r\n                        if (_sanitizers[lp].handleField(path, name)) {\r\n                            result = {\r\n                                canHandle: true,\r\n                                handler: _sanitizers[lp],\r\n                                fieldHandler: null\r\n                            };\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                if (!fieldLookup) {\r\n                    fieldLookup = _sanitizerMap[path] = {};\r\n                }\r\n                fieldLookup[name] = result;\r\n            }\r\n            return result;\r\n        }\r\n        _self.addSanitizer = function (newSanitizer) {\r\n            if (newSanitizer) {\r\n                _sanitizers.push(newSanitizer);\r\n                // Invalidate any previously mapped fields\r\n                _sanitizerMap = {};\r\n            }\r\n        };\r\n        _self.addFieldSanitizer = function (fieldSanitizer) {\r\n            if (fieldSanitizer) {\r\n                _fieldSanitizers.push(fieldSanitizer);\r\n                // Invalidate any previously mapped fields\r\n                _sanitizerMap = {};\r\n            }\r\n        };\r\n        _self.handleField = function (path, name) {\r\n            var mapValue = _getFieldSanitizer(path, name);\r\n            return mapValue ? mapValue.canHandle : false;\r\n        };\r\n        _self.value = function (path, name, value, stringifyObjects) {\r\n            var mapValue = _getFieldSanitizer(path, name);\r\n            if (mapValue && mapValue.canHandle) {\r\n                if (!mapValue || !mapValue.canHandle) {\r\n                    return null;\r\n                }\r\n                if (mapValue.handler) {\r\n                    // This value sanitizer can't handle this field so pass it only the next one\r\n                    return mapValue.handler.value(path, name, value, stringifyObjects);\r\n                }\r\n                // Check that property is valid\r\n                if (!isString(name) || isNullOrUndefined(value) || value === \"\") {\r\n                    return null;\r\n                }\r\n                var property = null;\r\n                var fieldType = getFieldValueType(value);\r\n                if ((fieldType & 8192 /* FieldValueSanitizerType.EventProperty */) === 8192 /* FieldValueSanitizerType.EventProperty */) {\r\n                    var subType = fieldType & ~8192 /* FieldValueSanitizerType.EventProperty */;\r\n                    property = value;\r\n                    if (!isValueAssigned(property.value) ||\r\n                        (subType !== 1 /* FieldValueSanitizerType.String */ &&\r\n                            subType !== 2 /* FieldValueSanitizerType.Number */ &&\r\n                            subType !== 3 /* FieldValueSanitizerType.Boolean */ &&\r\n                            (subType & 4096 /* FieldValueSanitizerType.Array */) !== 4096 /* FieldValueSanitizerType.Array */)) {\r\n                        // Not a supported IEventProperty type to be able to sanitize\r\n                        return null;\r\n                    }\r\n                }\r\n                else if (fieldType === 1 /* FieldValueSanitizerType.String */ ||\r\n                    fieldType === 2 /* FieldValueSanitizerType.Number */ ||\r\n                    fieldType === 3 /* FieldValueSanitizerType.Boolean */ ||\r\n                    (fieldType & 4096 /* FieldValueSanitizerType.Array */) === 4096 /* FieldValueSanitizerType.Array */) {\r\n                    // If the property isn't IEventProperty (and is either string, number, boolean or array), convert it into one.\r\n                    property = _convertToProperty(path, name, value);\r\n                }\r\n                else if (fieldType === 4 /* FieldValueSanitizerType.Object */) {\r\n                    property = _convertToProperty(path, name, !!stringifyObjects ? JSON.stringify(value) : value);\r\n                }\r\n                if (property) {\r\n                    return _handleProperty(mapValue, path, name, fieldType, property, stringifyObjects);\r\n                }\r\n            }\r\n            return null;\r\n        };\r\n        _self.property = function (path, name, property, stringifyObjects) {\r\n            var mapValue = _getFieldSanitizer(path, name);\r\n            if (!mapValue || !mapValue.canHandle) {\r\n                return null;\r\n            }\r\n            // Check that property is valid\r\n            if (!isString(name) || isNullOrUndefined(property) || !isValueAssigned(property.value)) {\r\n                return null;\r\n            }\r\n            var fieldType = getFieldValueType(property.value);\r\n            if (fieldType === 0 /* FieldValueSanitizerType.NotSet */) {\r\n                // Not a supported field that we can sanitize or serialize\r\n                return null;\r\n            }\r\n            return _handleProperty(mapValue, path, name, fieldType, property, stringifyObjects);\r\n        };\r\n        function _handleProperty(mapValue, path, name, fieldType, property, stringifyObjects) {\r\n            if (mapValue.handler) {\r\n                // This value sanitizer can't handle this field so pass it only the next one\r\n                return mapValue.handler.property(path, name, property, stringifyObjects);\r\n            }\r\n            // If either pii or cc is set convert value to string (since only string pii/cc is allowed).\r\n            // If the value is a complex type like an array that can't be converted to string we will drop\r\n            // the property.\r\n            if (!isNullOrUndefined(property.kind)) {\r\n                if ((fieldType & 4096 /* FieldValueSanitizerType.Array */) === 4096 /* FieldValueSanitizerType.Array */ || !isValueKind(property.kind)) {\r\n                    return null;\r\n                }\r\n                // Convert the value to a string and assign back to the original value\r\n                property.value = property.value.toString();\r\n            }\r\n            return _callFieldSanitizer(mapValue.fieldHandler, path, name, fieldType, property);\r\n        }\r\n        function _convertToProperty(path, name, value) {\r\n            if (isValueAssigned(value)) {\r\n                return { value: value };\r\n            }\r\n            return null;\r\n        }\r\n        function _callFieldSanitizer(fieldProvider, path, name, theType, property) {\r\n            if (property && fieldProvider) {\r\n                var sanitizer = fieldProvider.getSanitizer(path, name, theType, property.kind, property.propertyType);\r\n                if (sanitizer) {\r\n                    // This is where we the field will call the handler to \"scrub\" the value. This the primary hook for the ClientHashing Plugin to\r\n                    // be able to apply the hashFunc() / Sha256 conversion of the properties value\r\n                    if (theType === 4 /* FieldValueSanitizerType.Object */) {\r\n                        // Special case of an embedded object (ext.metadata, data.properties)\r\n                        var newValue_1 = {};\r\n                        var propValue = property.value;\r\n                        objForEachKey(propValue, function (propKey, theValue) {\r\n                            var newPath = path + \".\" + name;\r\n                            if (isValueAssigned(theValue)) {\r\n                                var newProp = _convertToProperty(newPath, propKey, theValue);\r\n                                newProp = _callFieldSanitizer(fieldProvider, newPath, propKey, getFieldValueType(theValue), newProp);\r\n                                if (newProp) {\r\n                                    newValue_1[propKey] = newProp.value;\r\n                                }\r\n                            }\r\n                        });\r\n                        property.value = newValue_1;\r\n                    }\r\n                    else {\r\n                        var details = {\r\n                            path: path,\r\n                            name: name,\r\n                            type: theType,\r\n                            prop: property,\r\n                            sanitizer: _self\r\n                        };\r\n                        property = sanitizer.call(_self, details);\r\n                    }\r\n                }\r\n            }\r\n            return property;\r\n        }\r\n    }\r\n    ValueSanitizer.getFieldType = getFieldValueType;\r\n    return ValueSanitizer;\r\n}());\r\nexport { ValueSanitizer };\r\n//# sourceMappingURL=ValueSanitizer.js.map"],"names":["ValueKind","createEnumStyle","NotSet","Pii_DistinguishedName","Pii_GenericData","Pii_IPV4Address","Pii_IPv6Address","Pii_MailSubject","Pii_PhoneNumber","Pii_QueryString","Pii_SipAddress","Pii_SmtpAddress","Pii_Identity","Pii_Uri","Pii_Fqdn","Pii_IPV4AddressLegacy","CustomerContent_GenericContent","EventLatency","Normal","CostDeferred","RealTime","Immediate","EventPropertyType","Unspecified","String","Int32","UInt32","Int64","UInt64","Double","Bool","Guid","DateTime","EventPersistence","Critical","TraceLevel","NONE","ERROR","WARNING","INFORMATION","_ExtendedInternalMessageId","objFreeze","__assign","_InternalMessageId","AuthHandShakeError","AuthRedirectFail","BrowserCannotReadLocalStorage","BrowserCannotWriteLocalStorage","BrowserDoesNotSupportLocalStorage","CannotParseBiBlobValue","CannotParseDataAttribute","CVPluginNotAvailable","DroppedEvent","ErrorParsingAISessionCookie","ErrorProvidedChannels","FailedToGetCookies","FailedToInitializeCorrelationVector","FailedToInitializeSDK","InvalidContentBlob","InvalidCorrelationValue","SessionRenewalDateIsZero","SendPostOnCompleteFailure","PostResponseHandler","SDKNotInitialized","Version","FullVersionString","strWithCredentials","_fieldTypeEventPropMap","_a","uInt8ArraySupported","isDocumentObjectAvailable","getDocument","isWindowObjectAvailable","getWindow","isValueAssigned","value","isNullOrUndefined","getTenantId","apiKey","indexTenantId","indexOf","substring","isUint8ArrayAvailable","isUndefined","Uint8Array","nav","getNavigator","userAgent","ua","toLowerCase","isSafariOrFirefox","isReactNative","isLatency","isNumber","sanitizeProperty","name","property","stringifyObjects","propType","isArray","hasOwnProperty","isString","isBoolean","JSON","stringify","isArrayValid","kind","isValueKind","toString","getCommonSchemaMetaData","type","encodedTypeValue","getFieldValueType","disableCookies","safeGetCookieMgr","setEnabled","setCookie","days","areCookiesSupported","set","deleteCookie","del","getCookie","getCookieValue","cookieMgr","decode","cookieValue","get","decodeURIComponent","createGuid","style","theGuid","newGuid","replace","extend","obj","obj2","obj3","obj4","obj5","extended","deep","i","length","arguments","objProto","Object","strPrototype","theArgs","call","objForEachKey","prop","isObject","arrForEach","arrayValue","arrayIndex","getTime","perfNow","setProcessTelemetryTimings","event","identifier","evt","timings","processTelemetryStart","objType","theType","undefined","strShimObject","_super","Utils","strUndefined","strObject","Undefined","arrIndexOf","arrMap","arrReduce","objKeys","toISOString","isFunction","strTrim","isBeaconsSupported","getISOString","useXDomainRequest","cookieAvailable","disallowsSameSiteNone","uaDisallowsSameSiteNone","objDefineAccessors","addPageUnloadEventListener","addEventHandler","strEndsWith","CoreUtils","_canUseCookies","isTypeof","isDate","isError","objCreate","objCreateFn","dateNow","isIE","newId","randomValue","random32","mwcRandomSeed","mwcRandom32","generateW3CId","PropVersion","properties","AppInsightsCore","InternalCore","__extends","_this","this","pluginVersionStringArr","pluginVersionString","dynamicProto","_self","_base","logger","queue","DiagnosticLogger","loggingLevelConsole","initialize","config","extensions","notificationManager","doPerf","endpointUrl","propertyStorageOverride","getProperty","setProperty","Error","channels","channel","version","ver","push","getWParam","document","ext","join","pollInternalLogs","e","logger_1","message","dumpObj","throwInternal","track","item","itemProperties","telemetryItem","trackStart","latency","itemExt","sdk","baseData","BaseCore","_throwInternal","_isFunction","ESPromise","resolve","then","reject","error","reason","all","iterable","values_1","pending_2","lp","values","index","_createPromiseAllOnResolvedFunction","setTimeout","race","_loop_1","resolverFunc","_state","_settledValue","_queue","_enqueue","onResolved","onRejected","_processQueue","pending_1","slice","len","_reject","TypeError","_schedulerId","_running","_waiting","_timedOut","_getTime","Date","ESPromiseScheduler","incomplete","waitingToStart","diagLog","_promiseId","_scheduledName","_debugLog","global","getGlobal","console","log","_warnLog","warnToConsole","_lastEvent","_eventCount","_removeQueuedEvent","eventId","id","splice","scheduleEvent","startEventAction","eventName","timeout","eventDetails","waitForEvent","waitEvent","uniqueId","uniqueEventId","newScheduledEvent","tm","isRunning","isAborted","waitResolve","waitReject","runTime","prevId","abort","_startWaitingEvent","_schId","_abortAndRemoveOldEvents","eventQueue","now","expired","_cleanup","completed","toQueue","removed","to","clearTimeout","_removeScheduledEvent","callback","_createScheduledEvent","startEvent","schEventResolve","schEventReject","wTm","startResult","_waitForFinalResult","theResult","ValueSanitizer","getFieldType","fieldSanitizerProvider","_sanitizerMap","_sanitizers","_fieldSanitizers","_getFieldSanitizer","path","fieldLookup","result","handleField","canHandle","fieldHandler","handler","_handleProperty","mapValue","fieldType","_callFieldSanitizer","fieldProvider","sanitizer","newValue_1","propValue","getSanitizer","propertyType","propKey","theValue","newProp","newPath","_convertToProperty","addSanitizer","newSanitizer","addFieldSanitizer","fieldSanitizer","subType","getGlobalInst","method","urlString","withCredentials","disabled","isSync","_wrapSetXhrProp","xhr","XMLHttpRequest","open"],"mappings":"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"}